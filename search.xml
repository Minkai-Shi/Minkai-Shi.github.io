<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>AutoClick</title>
    <url>/2025/04/05/AutoClick/</url>
    <content><![CDATA[<h1 id="AutoClicker-自动点击器应用"><a href="#AutoClicker-自动点击器应用" class="headerlink" title="AutoClicker - 自动点击器应用"></a>AutoClicker - 自动点击器应用</h1><hr>
<h2 id="Project-Background-项目背景"><a href="#Project-Background-项目背景" class="headerlink" title="Project Background | 项目背景"></a><strong>Project Background | 项目背景</strong></h2><p>My mother often participates in time-limited sales, but manual operations are too slow. To solve this, I developed AutoClicker—an Android app that simulates screen clicks at user-defined times and coordinates. This project was optimized with AI-assisted debugging and is open-sourced on GitHub,.This app was developed to solve the challenge of time-sensitive operations (e.g., flash sales) by automating screen clicks at user-defined times and coordinates. Inspired by <strong>floating clock apps</strong> that display real-time information, this project adds a critical innovation: <strong>automated clicking functionality</strong> while showing precise timing in a floating window.<br>Since my mom started using this APP, snapping up items at the exact hour has become a piece of cake for her, and the success rate has soared. Every time she successfully grabs the desirable goods she wants, my mom can’t help but praise me, saying, “This kid is so smart! He developed such a useful APP for me!”<br><strong>开发背景：</strong> 我妈妈经常参与整点抢购，但由于手动操作速度有限，成功率低。为此，我开发了 AutoClicker，一款安卓自动点击工具，支持在设定的时间和坐标自动执行点击。灵感来源于悬浮时钟类APP的实时信息展示功能，但增加了关键创新：<strong>自动点击功能</strong>，并在悬浮窗中显示精确时间。此项目通过AI辅助完成代码优化和问题调试，现开源在GitHub。<br>自从妈妈开始用这款 APP，整点抢购对她来说就变得轻而易举，成功率直线上升。每次成功抢购到心仪好物，妈妈都忍不住夸我：“这孩子，可真机灵，给我开发了这么好用的APP！”</p>
<hr>
<h2 id="Technical-Highlights-技术亮点"><a href="#Technical-Highlights-技术亮点" class="headerlink" title="Technical Highlights | 技术亮点"></a><strong>Technical Highlights | 技术亮点</strong></h2><ol>
<li><p><strong>Real-Time Floating Window | 实时悬浮窗</strong><br>Displays current time with <strong>second precision</strong> (e.g., <code>08:29:29</code>) before triggering clicks.<br><strong>功能亮点：</strong> 执行点击前，悬浮窗实时显示精确到<strong>秒级</strong>的当前时间（如 <code>08:29:29</code>）。  </p>
</li>
<li><p><strong>Hybrid Design | 混合设计</strong><br>Combines the time-display logic of floating clock apps with automated click simulation, addressing a gap in existing tools.<br><strong>设计创新：</strong> 融合悬浮时钟类APP的时间显示逻辑与自动点击功能，填补了现有工具的空白。  </p>
</li>
<li><p><strong>Precision Timing | 精准时序控制</strong><br>Uses <code>AlarmManager</code> and <code>RTC_WAKEUP</code> to achieve click timing with &lt;10ms error margin.<br><strong>技术优势：</strong> 基于 <code>AlarmManager</code> 和 <code>RTC_WAKEUP</code> 实现误差小于10毫秒的精准触发。  </p>
</li>
<li><p><strong>Cross-Process Coordination | 跨进程协同</strong><br>Coordinates between the floating window (UI), background service, and accessibility service.<br><strong>系统集成：</strong> 实现悬浮窗（UI）、后台服务和无障碍服务的跨进程协同。</p>
</li>
</ol>
<hr>
<h2 id="Core-Features-核心功能"><a href="#Core-Features-核心功能" class="headerlink" title="Core Features | 核心功能"></a><strong>Core Features | 核心功能</strong></h2><h3 id="1-Floating-Window-with-Time-Display-带时间显示的悬浮窗"><a href="#1-Floating-Window-with-Time-Display-带时间显示的悬浮窗" class="headerlink" title="1. Floating Window with Time Display | 带时间显示的悬浮窗"></a>1. Floating Window with Time Display | 带时间显示的悬浮窗</h3><ul>
<li><strong>Real-Time Updates | 实时更新</strong><br>Continuously updates time using a <code>Handler</code> loop, synchronized with system clocks.<br><strong>实现原理：</strong> 通过 <code>Handler</code> 循环与系统时钟同步，持续更新时间。  </li>
<li><strong>Visual Feedback | 视觉反馈</strong><br>Shows countdown or real-time clock to enhance user trust in timing accuracy.<br><strong>用户体验：</strong> 显示倒计时或实时时钟，增强用户对时间精度的信任。</li>
</ul>
<h3 id="2-Automated-Click-Workflow-自动点击流程"><a href="#2-Automated-Click-Workflow-自动点击流程" class="headerlink" title="2. Automated Click Workflow | 自动点击流程"></a>2. Automated Click Workflow | 自动点击流程</h3><p><strong>Demo Video</strong>:<a href="https://youtube.com/shorts/9eFLo0zvitk">https://youtube.com/shorts/9eFLo0zvitk</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">graph TD</span><br><span class="line">    A[用户设置时间/坐标] --&gt; B[悬浮窗显示实时时间]</span><br><span class="line">    B --&gt; C&#123;到达指定时间?&#125;</span><br><span class="line">    C --&gt;|是| D[隐藏悬浮窗]</span><br><span class="line">    D --&gt; E[触发无障碍服务执行点击]</span><br><span class="line">    E --&gt; F[显示点击完成提示]</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="Technical-Implementation-技术实现"><a href="#Technical-Implementation-技术实现" class="headerlink" title="Technical Implementation | 技术实现"></a><strong>Technical Implementation | 技术实现</strong></h2><h3 id="1-Floating-Window-Design-悬浮窗设计"><a href="#1-Floating-Window-Design-悬浮窗设计" class="headerlink" title="1. Floating Window Design | 悬浮窗设计"></a>1. Floating Window Design | 悬浮窗设计</h3><ul>
<li><strong>参考悬浮时钟APP的架构：</strong><br>Used <code>WindowManager</code> to create an overlay view, similar to floating clock apps, but added dynamic time formatting and click-trigger logic.<br><strong>实现细节：</strong> 基于 <code>WindowManager</code> 创建覆盖层视图（参考悬浮时钟APP），但新增动态时间格式化和点击触发逻辑。  </li>
<li><strong>代码片段：</strong>  <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 更新悬浮窗时间</span></span><br><span class="line">handler.postDelayed(<span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        textView.setText(getCurrentTimeWithMillis());</span><br><span class="line">        handler.postDelayed(<span class="built_in">this</span>, <span class="number">10</span>); <span class="comment">// 每10ms更新一次</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;, <span class="number">10</span>);</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="2-Key-Improvements-Over-Floating-Clock-Apps-相较于悬浮时钟APP的改进"><a href="#2-Key-Improvements-Over-Floating-Clock-Apps-相较于悬浮时钟APP的改进" class="headerlink" title="2. Key Improvements Over Floating Clock Apps | 相较于悬浮时钟APP的改进"></a>2. Key Improvements Over Floating Clock Apps | 相较于悬浮时钟APP的改进</h3><table>
<thead>
<tr>
<th>Feature Comparison</th>
<th>Floating Clock App</th>
<th>AutoClicker</th>
</tr>
</thead>
<tbody><tr>
<td><strong>Core Functionality</strong></td>
<td>Time display only</td>
<td>Time display + <strong>Auto-clicking</strong></td>
</tr>
<tr>
<td><strong>Trigger Logic</strong></td>
<td>None</td>
<td>Millisecond-level timed triggering</td>
</tr>
<tr>
<td><strong>System Permissions</strong></td>
<td>Only requires floating window access</td>
<td>Requires floating window + accessibility service permissions</td>
</tr>
</tbody></table>
<p>Key differences explained:  </p>
<ol>
<li><strong>Core Functionality</strong>: Floating clock apps focus solely on time visualization with various display styles, while AutoClickers integrate timing functions with automated click operations for tasks like gaming&#x2F;shopping assistance.  </li>
<li><strong>Trigger Mechanism</strong>: AutoClickers require precise timing configuration (millisecond accuracy) to execute automated actions, unlike passive clock displays.  </li>
<li><strong>Permissions</strong>: AutoClickers need deeper system access (accessibility services) to simulate user interactions, whereas floating clocks only need basic overlay permissions.</li>
</ol>
<table>
<thead>
<tr>
<th>功能对比</th>
<th>悬浮时钟APP</th>
<th>AutoClicker</th>
</tr>
</thead>
<tbody><tr>
<td><strong>核心功能</strong></td>
<td>仅显示时间</td>
<td>时间显示 + <strong>自动点击</strong></td>
</tr>
<tr>
<td><strong>触发逻辑</strong></td>
<td>无</td>
<td>毫秒级定时触发</td>
</tr>
<tr>
<td><strong>系统权限</strong></td>
<td>仅需悬浮窗权限</td>
<td>需悬浮窗 + 无障碍服务权限</td>
</tr>
</tbody></table>
<hr>
<h2 id="Challenges-Solutions-开发挑战与解决方案"><a href="#Challenges-Solutions-开发挑战与解决方案" class="headerlink" title="Challenges &amp; Solutions | 开发挑战与解决方案"></a><strong>Challenges &amp; Solutions | 开发挑战与解决方案</strong></h2><ol>
<li><p><strong>悬浮窗与点击服务的协同</strong>  </p>
<ul>
<li><strong>Challenge:</strong> Coordinating floating window visibility with click execution.  </li>
<li><strong>Solution:</strong> Hide the window via <code>Broadcast</code> before clicking and restore it afterward.  </li>
<li>问题：悬浮窗需持续显示时间，但点击时需隐藏以避免遮挡。  </li>
<li>解决：通过 <code>Broadcast</code> 在点击前隐藏悬浮窗，完成后恢复显示。</li>
</ul>
</li>
<li><p><strong>跨版本兼容性</strong>  </p>
<ul>
<li><strong>Challenge:</strong> Android 12+ restrictions on exact alarms.  </li>
<li><strong>Solution:</strong> Dynamically detect OS version and switch between <code>setExact()</code> and <code>setAlarmClock()</code>.  </li>
<li>问题：Android 12+ 对精确闹钟的限制。  </li>
<li>解决：动态检测版本并适配 <code>setExact()</code> 或 <code>setAlarmClock()</code>。</li>
</ul>
</li>
</ol>
<hr>
<h2 id="Future-Plans-未来计划"><a href="#Future-Plans-未来计划" class="headerlink" title="Future Plans | 未来计划"></a><strong>Future Plans | 未来计划</strong></h2><ol>
<li><strong>Multi-Window Support | 多悬浮窗支持</strong><br>Allow users to track multiple countdowns simultaneously.<br><strong>功能扩展：</strong> 支持同时追踪多个倒计时任务。  </li>
<li><strong>Accessibility Event Filtering | 无障碍事件过滤</strong><br>Improve efficiency by filtering irrelevant <code>AccessibilityEvent</code> data.<br><strong>性能优化：</strong> 通过过滤无关的无障碍事件提升效率。</li>
</ol>
<hr>
<p><strong>GitHub Repository:</strong> <a href="https://github.com/Minkai-Shi/AutoClicker">AutoClicker</a><br><strong>License:</strong> Apache 2.0  </p>
]]></content>
      <categories>
        <category>Android Studio Kotlin</category>
      </categories>
      <tags>
        <tag>Android Studio Kotlin</tag>
      </tags>
  </entry>
  <entry>
    <title>Cleaning of the Sailor 14K Four Seasons Weaving Dyeing Pen Rod</title>
    <url>/2024/07/02/Cleaning-of-the-Sailor-14K/</url>
    <content><![CDATA[<p>Cleaning of the Sailor 14K Four Seasons Weaving Dyeing Pen Rod. Inject ink and repeatedly inhale clean water, seal the pen cap with a tissue, and remove the pen tip seal sleeve. For the assembly part, use rubber to pinch the plastic pen holder and unscrew the metal thread separately. Take out the pen tip and tongue from the tip sleeve, loosen the metal sleeve at the waist of the ink dispenser, and remove the screw piston head. All the above parts should be cleaned of the mixture of ink and water, as well as dust and silicone oil, and air dried. Silicone oil should be applied around the piston head, and the thread of the pen grip should be fixed with insect glue. The remaining parts should be reinstalled in their original state.That’s all<br><img src="/upload/Sailor1.jpg" alt="pic1" title="pic1"></p>
]]></content>
      <categories>
        <category>pen</category>
      </categories>
      <tags>
        <tag>pen</tag>
      </tags>
  </entry>
  <entry>
    <title>DIY Light Meter Project</title>
    <url>/2024/12/20/DIY-Light-Meter-Project/</url>
    <content><![CDATA[<h1 id="DIY-Light-Meter-Project-Hardware-Integration-Software-Development"><a href="#DIY-Light-Meter-Project-Hardware-Integration-Software-Development" class="headerlink" title="DIY Light Meter Project: Hardware Integration &amp; Software Development"></a>DIY Light Meter Project: Hardware Integration &amp; Software Development</h1><h2 id="Project-Overview"><a href="#Project-Overview" class="headerlink" title="Project Overview"></a>Project Overview</h2><p>This project, part of <a href="https://www.eepw.com.cn/event/action/digikey/diy_third.html">“Let’s Do Activity” (Session 3)</a> by <strong>DigiKey</strong> and <strong>EEPW</strong>, aimed to build a programmable light meter using the <strong>Adafruit ESP32-S3 TFT Feather</strong> microcontroller. The device measures ambient light intensity, calculates optimal photography parameters (ISO, aperture, shutter speed), and enables remote control via WiFi. </p>
<hr>
<h2 id="Table-of-Contents"><a href="#Table-of-Contents" class="headerlink" title="Table of Contents"></a>Table of Contents</h2><ol>
<li><a href="#hardware-components">Hardware Components</a>  </li>
<li><a href="#system-architecture">System Architecture</a>  </li>
<li><a href="#software-implementation">Software Implementation</a>  </li>
<li><a href="#exposure-control-logic">Exposure Control Logic</a>  </li>
<li><a href="#technical-innovations">Technical Innovations</a>  </li>
<li><a href="#project-links">Project Links</a></li>
</ol>
<hr>
<h2 id="Hardware-Components"><a href="#Hardware-Components" class="headerlink" title="Hardware Components"></a>Hardware Components</h2><h3 id="Core-Modules"><a href="#Core-Modules" class="headerlink" title="Core Modules"></a>Core Modules</h3><ul>
<li><strong>Microcontroller</strong>: <a href="https://www.adafruit.com/product/5483">Adafruit ESP32-S3 TFT Feather</a>  <ul>
<li>Built-in TFT display (128x64 pixels)  </li>
<li>Dual-core Xtensa LX7 processor  </li>
<li>WiFi&#x2F;Bluetooth 5.0 support</li>
</ul>
</li>
<li><strong>Light Sensor</strong>: BH1750 (I2C interface, 1-65535 lux range)  </li>
<li><strong>Servo Motor</strong>: SG90 Micro Servo (180° rotation)  </li>
<li><strong>Control Interface</strong>: Dual-button module</li>
</ul>
<p><img src="/upload/hardware_assembly.jpg" alt="Hardware Assembly"><br><img src="/upload/hardware_assembly2.jpg" alt="Hardware Assembly"><br><em>Final prototype with labeled components</em></p>
<hr>
<h2 id="System-Architecture"><a href="#System-Architecture" class="headerlink" title="System Architecture"></a>System Architecture</h2><h3 id="Circuit-Design"><a href="#Circuit-Design" class="headerlink" title="Circuit Design"></a>Circuit Design</h3><table>
<thead>
<tr>
<th>Component</th>
<th>ESP32 Connection</th>
<th>Protocol</th>
</tr>
</thead>
<tbody><tr>
<td>BH1750 Sensor</td>
<td>GPIO6 (SDA), GPIO7 (SCL)</td>
<td>I2C</td>
</tr>
<tr>
<td>Servo Motor</td>
<td>GPIO10</td>
<td>PWM</td>
</tr>
<tr>
<td>Red Button</td>
<td>GPIO9</td>
<td>Digital</td>
</tr>
<tr>
<td>Blue Button</td>
<td>GPIO6</td>
<td>Digital</td>
</tr>
</tbody></table>
<h3 id="Key-Challenges-Solutions"><a href="#Key-Challenges-Solutions" class="headerlink" title="Key Challenges &amp; Solutions"></a>Key Challenges &amp; Solutions</h3><ol>
<li><strong>Debugging of Remote Control Methods</strong>  <ul>
<li>When the mobile phone can be used for control, Bluetooth or MQTT methods are planned to be adopted. However, the official manual of this version of the firmware does not support Bluetooth, and there is too little reference information for MQTT setup on io.adafruit. Later, the code for controlling WS2812B via the network found on the Internet was referenced and modified.<br>-The WiFi control part exchanges data with the web page through WebSocket. The websocket.send_message function transmits the measured and calculated data such as light intensity to the web page for display. The websocket.receive function receives the instructions from the buttons on the web page and calls the mode switching, parameter adjustment, and shooting functions respectively to realize the mobile phone remote control function.Enter <a href="http://192.168.66.121:1080/client">http://192.168.66.121:1080/client</a> in the browser of a computer or mobile phone to access the control website. Replace the IP address with the IP address output by the console.</li>
</ul>
</li>
<li><strong>Selection of Exposure Parameter Calculation Method</strong><br>-Direct calculation requires multiple mathematical operations, which slows down the processing speed and affects the shooting effect. When using exposure calculation formulas that involve complex mathematical operations such as logarithms and exponents, the code complexity is high.<br>-The lookup table method is chosen for calculation. Looking up a table only requires directly finding the corresponding output value based on the input value, avoiding complex mathematical operations. Therefore, the calculation speed is very fast, which is especially suitable for applications with high real-time requirements. In embedded systems, due to limited resources, simple lookup table code is easier to implement and debug.</li>
</ol>
<hr>
<h2 id="Software-Implementation"><a href="#Software-Implementation" class="headerlink" title="Software Implementation"></a>Software Implementation</h2><h3 id="Development-Stack"><a href="#Development-Stack" class="headerlink" title="Development Stack"></a>Development Stack</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Core dependencies</span></span><br><span class="line"><span class="keyword">import</span> adafruit_bh1750  <span class="comment"># Light sensor driver</span></span><br><span class="line"><span class="keyword">from</span> adafruit_motor <span class="keyword">import</span> servo  <span class="comment"># PWM control</span></span><br><span class="line"><span class="keyword">import</span> socketpool  <span class="comment"># Network communication</span></span><br></pre></td></tr></table></figure>

<h3 id="Exposure-Calculation-Engine"><a href="#Exposure-Calculation-Engine" class="headerlink" title="Exposure Calculation Engine"></a>Exposure Calculation Engine</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">calculate_ev</span>(<span class="params">lux: <span class="built_in">float</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Calculate Exposure Value using photographic formula&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">round</span>(<span class="number">2</span> + math.log(lux/<span class="number">10</span>)/math.log(<span class="number">2</span>))</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="Exposure-Control-Logic"><a href="#Exposure-Control-Logic" class="headerlink" title="Exposure Control Logic"></a>Exposure Control Logic</h2><h3 id="Priority-Modes-Implementation"><a href="#Priority-Modes-Implementation" class="headerlink" title="Priority Modes Implementation"></a>Priority Modes Implementation</h3><table>
<thead>
<tr>
<th>Mode</th>
<th>Core Algorithm</th>
<th>Use Case</th>
</tr>
</thead>
<tbody><tr>
<td><strong>ISO Priority</strong></td>
<td><code>TV = EV + SV - AV</code></td>
<td>Low-light photography</td>
</tr>
<tr>
<td><strong>Aperture Priority</strong></td>
<td><code>TV = EV + SV - AV</code></td>
<td>Portrait&#x2F;landscape</td>
</tr>
<tr>
<td><strong>Shutter Priority</strong></td>
<td><code>AV = EV + SV - TV</code></td>
<td>Action&#x2F;sports</td>
</tr>
</tbody></table>
<h3 id="Parameter-Mapping"><a href="#Parameter-Mapping" class="headerlink" title="Parameter Mapping"></a>Parameter Mapping</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Standard photographic sequences</span></span><br><span class="line">ISO_VALUES = [<span class="string">&quot;100&quot;</span>, <span class="string">&quot;200&quot;</span>, <span class="string">&quot;400&quot;</span>, <span class="string">&quot;800&quot;</span>, <span class="string">&quot;1600&quot;</span>]</span><br><span class="line">APERTURE_VALUES = [<span class="string">&quot;1.0&quot;</span>, <span class="string">&quot;1.4&quot;</span>, <span class="string">&quot;2.0&quot;</span>, <span class="string">&quot;2.8&quot;</span>, <span class="string">&quot;4.0&quot;</span>, <span class="string">&quot;5.6&quot;</span>, <span class="string">&quot;8.0&quot;</span>]</span><br><span class="line">SHUTTER_VALUES = [<span class="string">&quot;1&quot;</span>, <span class="string">&quot;1/2&quot;</span>, <span class="string">&quot;1/4&quot;</span>, <span class="string">&quot;1/8&quot;</span>, <span class="string">&quot;1/15&quot;</span>, <span class="string">&quot;1/30&quot;</span>, <span class="string">&quot;1/60&quot;</span>]</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="Demo-Video"><a href="#Demo-Video" class="headerlink" title="Demo Video"></a>Demo Video</h3><p><a href="https://youtu.be/znmnvBf8Q34"><img src="https://img.youtube.com/vi/znmnvBf8Q34/0.jpg" alt="Demo"></a></p>
<hr>
<h2 id="Technical-Innovations"><a href="#Technical-Innovations" class="headerlink" title="Technical Innovations"></a>Technical Innovations</h2><ol>
<li><p><strong>Hybrid Control Architecture</strong>  </p>
<ul>
<li>Unified physical buttons and WebSocket interface  </li>
<li>Fallback to AP mode when WiFi unavailable</li>
</ul>
</li>
<li><p><strong>Dynamic Parameter Optimization</strong>  </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">clamp</span>(<span class="params">value, max_val</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">min</span>(<span class="built_in">max</span>(<span class="number">0</span>, value), max_val-<span class="number">1</span>)  <span class="comment"># Prevent index overflow</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Real-time Telemetry</strong>  </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">websocket.send(<span class="string">f&quot;Lux:<span class="subst">&#123;lux&#125;</span> EV:<span class="subst">&#123;ev&#125;</span> ISO:<span class="subst">&#123;SV[sv]&#125;</span> AV:<span class="subst">&#123;AV[av]&#125;</span> TV:<span class="subst">&#123;TV[tv]&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="Project-Links"><a href="#Project-Links" class="headerlink" title="Project Links"></a>Project Links</h2><ul>
<li><strong>Full Source Code</strong>: <a href="https://github.com/Minkai-Shi/DIY-an-electronic-exposure-meter">GitHub Repository</a>  </li>
<li><strong>EEPW Forum Posts</strong>:  <ul>
<li><a href="https://forum.eepw.com.cn/thread/388122/1">Unboxing Announcement</a> </li>
<li><a href="https://forum.eepw.com.cn/thread/388123/1">Award Announcement</a>  </li>
<li><a href="https://forum.eepw.com.cn/thread/388125/1">Technical Documentation</a></li>
</ul>
</li>
<li><strong>Demo Video</strong>: <a href="https://youtu.be/DJd1A43Qwbo">YouTube</a></li>
</ul>
<hr>
]]></content>
      <categories>
        <category>EEPW &amp; EEWorld Activity</category>
      </categories>
      <tags>
        <tag>EEPW &amp; EEWorld Activity</tag>
      </tags>
  </entry>
  <entry>
    <title>Play with DFRobot Geiger Counter Module</title>
    <url>/2024/07/21/Geiger-Counter/</url>
    <content><![CDATA[<h1 id="DFRobot-Geiger-Counter-Project-Exploring-Radiation-Detection-with-Microcontrollers"><a href="#DFRobot-Geiger-Counter-Project-Exploring-Radiation-Detection-with-Microcontrollers" class="headerlink" title="DFRobot Geiger Counter Project: Exploring Radiation Detection with Microcontrollers"></a>DFRobot Geiger Counter Project: Exploring Radiation Detection with Microcontrollers</h1><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p> I participated in the EEPW forum activity to explore the DFRobot Geiger Counter module (SEN0463). This hands-on project allowed me to apply fundamental concepts such as sensor interfacing, microcontroller programming, signal processing, and wireless communication. By building and iterating on this radiation detection system using an ESP32 board, I gained practical experience in hardware-software integration, debugging, and data visualization—skills essential for studies and careers in fields like embedded systems, IoT, and nuclear engineering.</p>
<p>The project progressed from basic unboxing and theoretical background to advanced implementations with MicroPython, WiFi, and Bluetooth. Challenges like optimizing interrupt handling and ensuring accurate radiation conversions deepened my understanding of digital electronics and real-time systems.</p>
<p>Original forum activity: <a href="https://forum.eepw.com.cn/thread/379334/1">EEPW Thread</a></p>
<h2 id="Table-of-Contents"><a href="#Table-of-Contents" class="headerlink" title="Table of Contents"></a>Table of Contents</h2><ul>
<li><a href="#unboxing-experience">Unboxing Experience</a></li>
<li><a href="#history-of-geiger-counters">History of Geiger Counters</a></li>
<li><a href="#connecting-to-esp32-and-debugging">Connecting to ESP32 and Debugging</a></li>
<li><a href="#measuring-data">Measuring Data</a></li>
<li><a href="#micropython-implementation">MicroPython Implementation</a></li>
<li><a href="#measuring-radiation-and-displaying-via-wifi">Measuring Radiation and Displaying via WiFi</a></li>
<li><a href="#micropython-with-bluetooth-connection">MicroPython with Bluetooth Connection</a></li>
<li><a href="#conclusion-and-reflections">Conclusion and Reflections</a></li>
</ul>
<h2 id="Unboxing-Experience"><a href="#Unboxing-Experience" class="headerlink" title="Unboxing Experience"></a>Unboxing Experience</h2><p>From forum post: <a href="https://forum.eepw.com.cn/thread/381883/1">DFRobot盖革计数器模块评测-开箱体验</a></p>
<p>I discovered the “Playing with DFRobot Geiger Counter Module” activity on the EEPW forum and decided to purchase one for a DIY project. Ordered from DFRobot’s official Taobao store for 389 yuan (after discount: 385.54 yuan), it arrived the next day.</p>
<p>The package was a black box labeled SEN0463, Gravity Geiger Counter Module, Made in China. Inside an anti-static bag were the module and a matching three-wire cable (5V+, 5V-, digital interface). The Geiger tube model is M4011, with an operating voltage of 350-450V.</p>
<p>The back features the DFRobot interface with “DRIVE THE FUTURE.” The Arduino module’s 5V+&#x2F;-&#x2F;digital pins aren’t adjacent, so the cable required adaptation. I temporarily split it and connected to an ESP32 board: power to 5V&#x2F;GND, digital to pin 3 (official Arduino example uses D3).</p>
<p>Powered on: ACK LED flashes occasionally, buzzer beeps. Measured tube voltage ~210V with FNIRST oscilloscope&#x2F;multimeter (below nominal 400V, possibly due to wiring).</p>
<p> This initial step introduced me to hardware inspection and basic electrical measurements, reinforcing circuit analysis skills. Identifying voltage discrepancies highlighted the importance of precise connections in sensor systems.</p>
<h2 id="History-of-Geiger-Counters"><a href="#History-of-Geiger-Counters" class="headerlink" title="History of Geiger Counters"></a>History of Geiger Counters</h2><p>From forum post: <a href="https://forum.eepw.com.cn/thread/382148/1">基础知识：盖革（G-M）计数器的起源与发展</a></p>
<p>The G-M counter is a radiation detector invented in 1928 by German physicists Hans Geiger and Walter Müller. It operates on ionizing radiation principles: radiation ionizes gas atoms in the tube, producing free electrons and ion pairs that move under an electric field, creating a measurable current proportional to radiation intensity and energy. Used for measuring radiation, detecting sources, and studying cosmic rays.</p>
<p>The design improved spark counters by using a metal tube with a central wire anode for stable, sensitive detection. Innovations separated discharge timing and space.</p>
<p>Over time, improvements included gas mixtures, tube materials&#x2F;shapes, and electronics for broader applications.</p>
<p>Development stages:  </p>
<ol>
<li><strong>Invention (1928)</strong>: Metal tube with anode wire.  </li>
<li><strong>Improvements (1930s-1940s)</strong>: Gas optimization, materials, electronics.  </li>
<li><strong>Applications (1950s-1960s)</strong>: Nuclear tech, safety.  </li>
<li><strong>Further Development (1970s-Present)</strong>: New gases, digital electronics; used in PET&#x2F;CT scanners.</li>
</ol>
<p>Keywords: Geiger, counter, module, basic knowledge.</p>
<p> Researching this history built my foundational knowledge in radiation physics and detector electronics, It inspired me to explore how analog circuits amplify weak signals.</p>
<h2 id="Connecting-to-ESP32-and-Debugging"><a href="#Connecting-to-ESP32-and-Debugging" class="headerlink" title="Connecting to ESP32 and Debugging"></a>Connecting to ESP32 and Debugging</h2><p>From forum post: <a href="https://forum.eepw.com.cn/thread/382356/1">连接ESP32模块调试</a></p>
<p>After receiving the module, I purchased adapter pins for ESP32 connection. Official Arduino code uses D3, but ESP32’s pin 3 shares with Rx—switched to pin 14.</p>
<p><strong>Wiring:</strong>  </p>
<ul>
<li>DFRobot Geiger: D → ESP32 14, + → 5V, - → GND</li>
</ul>
<p>Imported library, compiled, uploaded. Serial outputs: CPM, nSv&#x2F;h, μSv&#x2F;h (nSv&#x2F;h × 0.001 &#x3D; μSv&#x2F;h). Local radiation ~0.05 μSv&#x2F;h.</p>
<p>Added OLED for readability.</p>
<p><strong>OLED (I2C) Wiring:</strong>  </p>
<ul>
<li>GND → GND, VCC → 5V, SCL → 18, SDA → 23</li>
</ul>
<p><strong>Source Code:</strong></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;DFRobot_Geiger.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;public.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Wire.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;SSD1306Wire.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> detect_pin 14</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SDA 23</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SCL 18</span></span><br><span class="line"></span><br><span class="line"><span class="function">SSD1306Wire <span class="title">display</span><span class="params">(<span class="number">0x3c</span>, SDA, SCL)</span></span>;</span><br><span class="line"><span class="function">DFRobot_Geiger <span class="title">geiger</span><span class="params">(detect_pin)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setup</span><span class="params">()</span></span>&#123;</span><br><span class="line">  Serial.<span class="built_in">begin</span>(<span class="number">115200</span>);</span><br><span class="line">  geiger.<span class="built_in">start</span>();</span><br><span class="line">  display.<span class="built_in">init</span>();</span><br><span class="line">  display.<span class="built_in">flipScreenVertically</span>();</span><br><span class="line">  display.<span class="built_in">setFont</span>(ArialMT_Plain_24);</span><br><span class="line">  display.<span class="built_in">drawString</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="string">&quot;Geiger Counter&quot;</span>);</span><br><span class="line">  display.<span class="built_in">display</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">loop</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="type">char</span> s[<span class="number">5</span>];</span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">3000</span>);</span><br><span class="line"></span><br><span class="line">  Serial.<span class="built_in">println</span>(geiger.<span class="built_in">getCPM</span>());</span><br><span class="line">  Serial.<span class="built_in">println</span>(geiger.<span class="built_in">getnSvh</span>());</span><br><span class="line">  Serial.<span class="built_in">println</span>(geiger.<span class="built_in">getuSvh</span>());</span><br><span class="line"></span><br><span class="line">  display.<span class="built_in">clear</span>();</span><br><span class="line">  display.<span class="built_in">setFont</span>(ArialMT_Plain_10);</span><br><span class="line">  display.<span class="built_in">setTextAlignment</span>(TEXT_ALIGN_CENTER);</span><br><span class="line">  display.<span class="built_in">drawString</span>(<span class="number">64</span>, <span class="number">0</span>, <span class="built_in">String</span>(<span class="string">&quot;Geiger Counter&quot;</span>));</span><br><span class="line">  display.<span class="built_in">drawString</span>(<span class="number">32</span>, <span class="number">10</span>, <span class="built_in">String</span>(geiger.<span class="built_in">getCPM</span>()));</span><br><span class="line">  display.<span class="built_in">drawString</span>(<span class="number">64</span>, <span class="number">10</span>, <span class="built_in">String</span>(<span class="string">&quot;CPM&quot;</span>));</span><br><span class="line">  display.<span class="built_in">drawString</span>(<span class="number">32</span>, <span class="number">20</span>, <span class="built_in">String</span>(geiger.<span class="built_in">getnSvh</span>()));</span><br><span class="line">  display.<span class="built_in">drawString</span>(<span class="number">64</span>, <span class="number">20</span>, <span class="built_in">String</span>(<span class="string">&quot;nSv/h&quot;</span>));  </span><br><span class="line">  <span class="built_in">dtostrf</span>(geiger.<span class="built_in">getuSvh</span>(),<span class="number">1</span>,<span class="number">2</span>,s);</span><br><span class="line">  display.<span class="built_in">drawString</span>(<span class="number">32</span>, <span class="number">30</span>, s);</span><br><span class="line">  display.<span class="built_in">drawString</span>(<span class="number">64</span>, <span class="number">30</span>, <span class="built_in">String</span>(<span class="string">&quot;uSv/h&quot;</span>));</span><br><span class="line"></span><br><span class="line">  display.<span class="built_in">display</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://minkai-shi.github.io/upload/geiger/geiger1.jpg" alt="OLED Display Effect"></p>
<p> Interfacing the sensor with ESP32 taught me about interrupts and I2C communication. Debugging pin conflicts and voltage issues honed my troubleshooting skills, preparing me for complex circuit design projects.</p>
<h2 id="Measuring-Data"><a href="#Measuring-Data" class="headerlink" title="Measuring Data"></a>Measuring Data</h2><p>From forum post: <a href="https://forum.eepw.com.cn/thread/382524/1">用DFRobot盖革计数器模块测量数据</a></p>
<p>Adjusted OLED font to ArialMT_Plain_16 for visibility, showing title + CPM and μSv&#x2F;h (nSv&#x2F;h omitted). Used <code>dtostrf</code> for μSv&#x2F;h float-to-string conversion (1 digit before decimal, 3 after).</p>
<p><strong>Code Snippet:</strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">dtostrf(geiger.getuSvh(),<span class="number">1</span>,<span class="number">3</span>,s);</span><br><span class="line">display.drawString(<span class="number">32</span>, <span class="number">40</span>, s );</span><br></pre></td></tr></table></figure>

<p>Uploaded to ESP32 flash, powered by power bank for portability. Measured marble&#x2F;wood floors: near background levels.</p>
<p><img src="https://minkai-shi.github.io/upload/geiger/geiger2.jpg" alt="marble"></p>
<p>Tested with ionic smoke detector (Am-241 source): ~0.232 μSv&#x2F;h close—safe (nuclear workers: 100mSv&#x2F;5yr ≈ 0.57 μSv&#x2F;h).</p>
<p><img src="https://minkai-shi.github.io/upload/geiger/geiger3.jpg" alt="smoke detector"><br><img src="https://minkai-shi.github.io/upload/geiger/geiger4.jpg" alt="smoke detector"></p>
<p>Reference: <a href="https://zhuanlan.zhihu.com/p/463435752">Ionic smoke sensor with Am-241</a></p>
<p> Handling floating-point conversions and portable power systems mirrored challenges in sensor networks, enhancing my interest in signal conditioning and low-power design.</p>
<h2 id="MicroPython-Implementation"><a href="#MicroPython-Implementation" class="headerlink" title="MicroPython Implementation"></a>MicroPython Implementation</h2><p>From forum post: <a href="https://forum.eepw.com.cn/thread/382696/1">MicroPython实现DFrobot盖革计数器功能</a></p>
<p>Rewrote Arduino code in MicroPython: interrupts for counting, buffer 20 samples (1 min) for stable CPM. Converts to μSv&#x2F;h (CPM &#x2F; 151). Wiring same as before.</p>
<p><strong>Code:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">DFrobot 盖革计数器实验</span></span><br><span class="line"><span class="string">接线说明：DFrobot Geiger模块--&gt;ESP32 IO</span></span><br><span class="line"><span class="string">         (D)--&gt;(14)</span></span><br><span class="line"><span class="string">         (+)--&gt;(5V)</span></span><br><span class="line"><span class="string">         (-)--&gt;(GND)</span></span><br><span class="line"><span class="string">         </span></span><br><span class="line"><span class="string">OLED(IIC)液晶模块--&gt;ESP32 IO</span></span><br><span class="line"><span class="string">         GND--&gt;(GND)</span></span><br><span class="line"><span class="string">         VCC--&gt;(5V)</span></span><br><span class="line"><span class="string">         SCL--&gt;(18)</span></span><br><span class="line"><span class="string">         SDA--&gt;(23)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment">#导入Pin模块</span></span><br><span class="line"><span class="keyword">from</span> machine <span class="keyword">import</span> Pin</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> machine <span class="keyword">import</span> SoftI2C</span><br><span class="line"><span class="keyword">from</span> ssd1306 <span class="keyword">import</span> SSD1306_I2C  <span class="comment">#I2C的oled选该方法</span></span><br><span class="line"><span class="comment">#创建软件I2C对象</span></span><br><span class="line">i2c = SoftI2C(sda=Pin(<span class="number">23</span>), scl=Pin(<span class="number">18</span>))</span><br><span class="line"><span class="comment">#创建OLED对象，OLED分辨率、I2C接口</span></span><br><span class="line">oled = SSD1306_I2C(<span class="number">128</span>, <span class="number">64</span>, i2c) </span><br><span class="line"><span class="comment">#Geiger in</span></span><br><span class="line">Geiger_In=Pin(<span class="number">14</span>,Pin.IN,Pin.PULL_UP)</span><br><span class="line"><span class="comment">#Geiger计数器外部中断函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Geiger_In_irq</span>(<span class="params">Geiger_In</span>):</span><br><span class="line">    <span class="keyword">global</span> numPulse</span><br><span class="line">    numPulse = numPulse + <span class="number">1</span> </span><br><span class="line"><span class="comment">#程序入口</span></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">global</span> numPulse</span><br><span class="line">    BUFFER_SIZE = <span class="number">20</span></span><br><span class="line">    rows, cols = <span class="number">2</span>, BUFFER_SIZE</span><br><span class="line">    mem_data = [[<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(cols)] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(rows)]</span><br><span class="line">    numPulse = <span class="number">0</span></span><br><span class="line">    pos = <span class="number">0</span>    </span><br><span class="line">    oled.fill(<span class="number">0</span>)  <span class="comment">#清空屏幕    </span></span><br><span class="line">    oled.text(<span class="string">&quot;Geiger Counter&quot;</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>)  <span class="comment">#显示字符串</span></span><br><span class="line">    oled.show()  <span class="comment">#执行显示    </span></span><br><span class="line">    Geiger_In.irq(Geiger_In_irq,Pin.IRQ_FALLING)  <span class="comment">#配置外部中断，下降沿触发</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:  </span><br><span class="line">        time.sleep_ms(<span class="number">3000</span>)</span><br><span class="line">        mem_data[<span class="number">0</span>][pos] = time.ticks_ms()</span><br><span class="line">        mem_data[<span class="number">1</span>][pos] = numPulse</span><br><span class="line">        numPulse = <span class="number">0</span></span><br><span class="line">        cpm=<span class="number">0</span></span><br><span class="line">        pos_old = pos</span><br><span class="line">        pos = (pos+<span class="number">1</span>)%BUFFER_SIZE        </span><br><span class="line">        numAll = <span class="number">0</span></span><br><span class="line">        time_now = mem_data[<span class="number">0</span>][pos_old] </span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, BUFFER_SIZE - <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> mem_data[<span class="number">0</span>][pos_old] != <span class="number">0</span>:</span><br><span class="line">                numAll = numAll + mem_data[<span class="number">1</span>][pos_old]</span><br><span class="line">                time_old = mem_data[<span class="number">0</span>][pos_old]</span><br><span class="line">                <span class="keyword">if</span> pos_old == <span class="number">0</span>:</span><br><span class="line">                    pos_old =  BUFFER_SIZE - <span class="number">1</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    pos_old = pos_old - <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> time_now-time_old &gt; <span class="number">0</span>:</span><br><span class="line">            cpm = numAll*<span class="number">1000</span>*<span class="number">60</span>/(time_now-time_old)</span><br><span class="line">            </span><br><span class="line">        str1 = <span class="string">&quot;&#123;:.0f&#125;&quot;</span>.<span class="built_in">format</span>(cpm)    <span class="comment">#CPM转字符串</span></span><br><span class="line">        str2 = <span class="string">&quot;&#123;:.3f&#125;&quot;</span>.<span class="built_in">format</span>(cpm/<span class="number">151</span>)<span class="comment">#uSv/h转字符串</span></span><br><span class="line">        oled.fill(<span class="number">0</span>)  <span class="comment">#清空屏幕</span></span><br><span class="line">        oled.text(<span class="string">&quot;Geiger Counter&quot;</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>)  <span class="comment">#显示字符串</span></span><br><span class="line">        oled.text(<span class="string">&quot;CPM&quot;</span>,<span class="number">80</span>,<span class="number">10</span>,<span class="number">2</span>)  <span class="comment">#显示CPM单位</span></span><br><span class="line">        oled.text(<span class="string">&quot;uSv/h&quot;</span>,<span class="number">80</span>,<span class="number">20</span>,<span class="number">2</span>)  <span class="comment">#显示uSv/h单位</span></span><br><span class="line">        oled.text(str1,<span class="number">0</span>,<span class="number">10</span>,<span class="number">2</span>)  <span class="comment">#显示CPM数据</span></span><br><span class="line">        oled.text(str2,<span class="number">0</span>,<span class="number">20</span>,<span class="number">2</span>)  <span class="comment">#显示uSv/h数据</span></span><br><span class="line">        oled.show()  <span class="comment">#执行显示</span></span><br></pre></td></tr></table></figure>

<p> Porting to MicroPython improved my programming versatility,  Python is used in automation and data analysis. Buffering data for accuracy taught me about noise reduction in signals, relevant to control systems and DSP courses.</p>
<h2 id="Measuring-Radiation-and-Displaying-via-WiFi"><a href="#Measuring-Radiation-and-Displaying-via-WiFi" class="headerlink" title="Measuring Radiation and Displaying via WiFi"></a>Measuring Radiation and Displaying via WiFi</h2><p>From forum post: <a href="https://forum.eepw.com.cn/thread/382714/1">DFrobot模块测量辐射值并通过wifi显示</a></p>
<p>Added WiFi to display data on a web page. Connect to the same network, access ESP32 IP in browser for CPM&#x2F;μSv&#x2F;h.</p>
<p><strong>Code:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">DFrobot 盖革计数器实验</span></span><br><span class="line"><span class="string">接线说明：DFrobot Geiger模块--&gt;ESP32 IO</span></span><br><span class="line"><span class="string">         (D)--&gt;(14)</span></span><br><span class="line"><span class="string">         (+)--&gt;(5V)</span></span><br><span class="line"><span class="string">         (-)--&gt;(GND)</span></span><br><span class="line"><span class="string">         </span></span><br><span class="line"><span class="string">OLED(IIC)液晶模块--&gt;ESP32 IO</span></span><br><span class="line"><span class="string">         GND--&gt;(GND)</span></span><br><span class="line"><span class="string">         VCC--&gt;(5V)</span></span><br><span class="line"><span class="string">         SCL--&gt;(18)</span></span><br><span class="line"><span class="string">         SDA--&gt;(23)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment">#导入Pin模块</span></span><br><span class="line"><span class="keyword">from</span> machine <span class="keyword">import</span> Pin</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> machine <span class="keyword">import</span> SoftI2C</span><br><span class="line"><span class="keyword">from</span> ssd1306 <span class="keyword">import</span> SSD1306_I2C  <span class="comment">#I2C的oled选该方法</span></span><br><span class="line"><span class="keyword">import</span> network</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="comment">#连接的WIFI账号和密码，此处需要按照实际填写</span></span><br><span class="line">ssid = <span class="string">&quot;wifi&quot;</span></span><br><span class="line">password = <span class="string">&quot;******&quot;</span></span><br><span class="line"><span class="comment">#创建软件I2C对象</span></span><br><span class="line">i2c = SoftI2C(sda=Pin(<span class="number">23</span>), scl=Pin(<span class="number">18</span>))</span><br><span class="line"><span class="comment">#创建OLED对象，OLED分辨率、I2C接口</span></span><br><span class="line">oled = SSD1306_I2C(<span class="number">128</span>, <span class="number">64</span>, i2c) </span><br><span class="line"><span class="comment">#Geiger in</span></span><br><span class="line">Geiger_In=Pin(<span class="number">14</span>,Pin.IN,Pin.PULL_UP)</span><br><span class="line"><span class="comment">#定义LED控制对象</span></span><br><span class="line">led1=Pin(<span class="number">15</span>,Pin.OUT,Pin.PULL_DOWN)</span><br><span class="line"><span class="comment">#WIFI连接</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">wifi_connect</span>():</span><br><span class="line">    wlan=network.WLAN(network.STA_IF)  <span class="comment">#STA模式</span></span><br><span class="line">    wlan.active(<span class="literal">True</span>)  <span class="comment">#激活</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> wlan.isconnected():</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;conneting to network...&quot;</span>)</span><br><span class="line">        wlan.connect(ssid,password)  <span class="comment">#输入 WIFI 账号密码</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">not</span> wlan.isconnected():</span><br><span class="line">            led1.value(<span class="number">1</span>)</span><br><span class="line">            time.sleep_ms(<span class="number">300</span>)</span><br><span class="line">            led1.value(<span class="number">0</span>)</span><br><span class="line">            time.sleep_ms(<span class="number">300</span>)</span><br><span class="line">        led1.value(<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        led1.value(<span class="number">0</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;network information:&quot;</span>, wlan.ifconfig())</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"><span class="comment">#网页数据</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">web_page</span>():</span><br><span class="line">  html = <span class="string">&quot;&quot;&quot;&lt;!DOCTYPE HTML&gt;&lt;html&gt;</span></span><br><span class="line"><span class="string">&lt;head&gt;</span></span><br><span class="line"><span class="string">  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&gt;</span></span><br><span class="line"><span class="string">  &lt;link rel=&quot;stylesheet&quot; href=&quot;https://use.fontawesome.com/releases/v5.7.2/css/all.css&quot; integrity=&quot;sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr&quot; crossorigin=&quot;anonymous&quot;&gt;</span></span><br><span class="line"><span class="string">  &lt;style&gt;</span></span><br><span class="line"><span class="string">    html &#123;</span></span><br><span class="line"><span class="string">     font-family: Arial;</span></span><br><span class="line"><span class="string">     display: inline-block;</span></span><br><span class="line"><span class="string">     margin: 0px auto;</span></span><br><span class="line"><span class="string">     text-align: center;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    h2 &#123; font-size: 3.0rem; &#125;</span></span><br><span class="line"><span class="string">    p &#123; font-size: 3.0rem; &#125;</span></span><br><span class="line"><span class="string">    .units &#123; font-size: 1.2rem; &#125;</span></span><br><span class="line"><span class="string">    .dht-labels&#123;</span></span><br><span class="line"><span class="string">      font-size: 1.5rem;</span></span><br><span class="line"><span class="string">      vertical-align:middle;</span></span><br><span class="line"><span class="string">      padding-bottom: 15px;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  &lt;/style&gt;</span></span><br><span class="line"><span class="string">&lt;/head&gt;</span></span><br><span class="line"><span class="string">&lt;body&gt;</span></span><br><span class="line"><span class="string">  &lt;h2&gt;DFRobot Geiger Counter&lt;/h2&gt;</span></span><br><span class="line"><span class="string">  &lt;p&gt;</span></span><br><span class="line"><span class="string">    &lt;i class=&quot;fas fa-thermometer-half&quot; style=&quot;color:#059e8a;&quot;&gt;&lt;/i&gt; </span></span><br><span class="line"><span class="string">    &lt;span class=&quot;dht-labels&quot;&gt;cpm&lt;/span&gt; </span></span><br><span class="line"><span class="string">    &lt;span&gt;&quot;&quot;&quot;</span>+<span class="built_in">str</span>(cpm)+<span class="string">&quot;&quot;&quot;&lt;/span&gt;</span></span><br><span class="line"><span class="string">    &lt;sup class=&quot;units&quot;&gt;CPM&lt;/sup&gt;</span></span><br><span class="line"><span class="string">  &lt;/p&gt;</span></span><br><span class="line"><span class="string">  &lt;p&gt;</span></span><br><span class="line"><span class="string">    &lt;i class=&quot;fas fa-tint&quot; style=&quot;color:#00add6;&quot;&gt;&lt;/i&gt; </span></span><br><span class="line"><span class="string">    &lt;span class=&quot;dht-labels&quot;&gt;uSvh&lt;/span&gt;</span></span><br><span class="line"><span class="string">    &lt;span&gt;&quot;&quot;&quot;</span>+<span class="built_in">str</span>(uSvh)+<span class="string">&quot;&quot;&quot;&lt;/span&gt;</span></span><br><span class="line"><span class="string">    &lt;sup class=&quot;uSv/h&quot;&gt;uSv/h&lt;/sup&gt;</span></span><br><span class="line"><span class="string">  &lt;/p&gt;</span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;&quot;&quot;&quot;</span></span><br><span class="line">  <span class="keyword">return</span> html</span><br><span class="line"><span class="comment">#Geiger计数器外部中断函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Geiger_In_irq</span>(<span class="params">Geiger_In</span>):</span><br><span class="line">    <span class="keyword">global</span> numPulse</span><br><span class="line">    numPulse = numPulse + <span class="number">1</span> </span><br><span class="line"><span class="comment">#程序入口</span></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">global</span> numPulse</span><br><span class="line">    BUFFER_SIZE = <span class="number">20</span></span><br><span class="line">    rows, cols = <span class="number">2</span>, BUFFER_SIZE</span><br><span class="line">    mem_data = [[<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(cols)] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(rows)]</span><br><span class="line">    numPulse = <span class="number">0</span></span><br><span class="line">    pos = <span class="number">0</span>    </span><br><span class="line">    oled.fill(<span class="number">0</span>)  <span class="comment">#清空屏幕    </span></span><br><span class="line">    oled.text(<span class="string">&quot;Geiger Counter&quot;</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>)  <span class="comment">#显示字符串</span></span><br><span class="line">    oled.show()  <span class="comment">#执行显示</span></span><br><span class="line">    <span class="keyword">if</span> wifi_connect():</span><br><span class="line">    <span class="comment">#SOCK_STREAM表示的是TCP协议，SOCK_DGRAM表示的是UDP协议</span></span><br><span class="line">        my_socket=socket.socket(socket.AF_INET, socket.SOCK_STREAM)  <span class="comment">#创建socket连接</span></span><br><span class="line">    <span class="comment"># 将socket对象绑定ip地址和端口号</span></span><br><span class="line">        my_socket.bind((<span class="string">&#x27;&#x27;</span>, <span class="number">80</span>))</span><br><span class="line">    <span class="comment"># 相当于电话的开机 括号里的参数表示可以同时接收5个请求</span></span><br><span class="line">        my_socket.listen(<span class="number">5</span>)    </span><br><span class="line">    </span><br><span class="line">        Geiger_In.irq(Geiger_In_irq,Pin.IRQ_FALLING)  <span class="comment">#配置外部中断，下降沿触发</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:  </span><br><span class="line">        time.sleep_ms(<span class="number">3000</span>)</span><br><span class="line">        mem_data[<span class="number">0</span>][pos] = time.ticks_ms()</span><br><span class="line">        mem_data[<span class="number">1</span>][pos] = numPulse</span><br><span class="line">        numPulse = <span class="number">0</span></span><br><span class="line">        cpm=<span class="number">0</span></span><br><span class="line">        pos_old = pos</span><br><span class="line">        pos = (pos+<span class="number">1</span>)%BUFFER_SIZE        </span><br><span class="line">        numAll = <span class="number">0</span></span><br><span class="line">        uSvh = <span class="number">0</span></span><br><span class="line">        time_now = mem_data[<span class="number">0</span>][pos_old] </span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, BUFFER_SIZE - <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> mem_data[<span class="number">0</span>][pos_old] != <span class="number">0</span>:</span><br><span class="line">                numAll = numAll + mem_data[<span class="number">1</span>][pos_old]</span><br><span class="line">                time_old = mem_data[<span class="number">0</span>][pos_old]</span><br><span class="line">                <span class="keyword">if</span> pos_old == <span class="number">0</span>:</span><br><span class="line">                    pos_old =  BUFFER_SIZE - <span class="number">1</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    pos_old = pos_old - <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> time_now-time_old &gt; <span class="number">0</span>:</span><br><span class="line">            cpm = numAll*<span class="number">1000</span>*<span class="number">60</span>/(time_now-time_old)</span><br><span class="line">            uSvh = cpm/<span class="number">151</span></span><br><span class="line">            </span><br><span class="line">        str1 = <span class="string">&quot;&#123;:.0f&#125;&quot;</span>.<span class="built_in">format</span>(cpm)    <span class="comment">#CPM转字符串</span></span><br><span class="line">        str2 = <span class="string">&quot;&#123;:.3f&#125;&quot;</span>.<span class="built_in">format</span>(uSvh)   <span class="comment">#uSv/h转字符串</span></span><br><span class="line">        oled.fill(<span class="number">0</span>)  <span class="comment">#清空屏幕</span></span><br><span class="line">        oled.text(<span class="string">&quot;Geiger Counter&quot;</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>)  <span class="comment">#显示字符串</span></span><br><span class="line">        oled.text(<span class="string">&quot;CPM&quot;</span>,<span class="number">80</span>,<span class="number">10</span>,<span class="number">2</span>)  <span class="comment">#显示CPM单位</span></span><br><span class="line">        oled.text(<span class="string">&quot;uSv/h&quot;</span>,<span class="number">80</span>,<span class="number">20</span>,<span class="number">2</span>)  <span class="comment">#显示uSv/h单位</span></span><br><span class="line">        oled.text(str1,<span class="number">0</span>,<span class="number">10</span>,<span class="number">2</span>)  <span class="comment">#显示CPM数据</span></span><br><span class="line">        oled.text(str2,<span class="number">0</span>,<span class="number">20</span>,<span class="number">2</span>)  <span class="comment">#显示uSv/h数据</span></span><br><span class="line">        oled.show()  <span class="comment">#执行显示</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;uSvh=&#x27;</span>,uSvh)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">                <span class="comment"># 进入监听状态，等待别人链接过来，有两个返回值，</span></span><br><span class="line">                <span class="comment">#一个是对方的socket对象，一个是对方的ip以及端口</span></span><br><span class="line">                client, addr = my_socket.accept()</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;Got a connection from %s&#x27;</span> % <span class="built_in">str</span>(addr))</span><br><span class="line">                <span class="comment"># recv表示接收，括号里是最大接收字节</span></span><br><span class="line">                request = client.recv(<span class="number">1024</span>)</span><br><span class="line">                request = <span class="built_in">str</span>(request)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;Content = %s&#x27;</span> % request)</span><br><span class="line">                <span class="comment">#sensor_readings = read_sensor()</span></span><br><span class="line">                <span class="comment">#print(sensor_readings)</span></span><br><span class="line">                response = web_page()</span><br><span class="line">                client.send(<span class="string">&#x27;HTTP/1.1 200 OK\n&#x27;</span>)</span><br><span class="line">                client.send(<span class="string">&#x27;Content-Type: text/html\n&#x27;</span>)</span><br><span class="line">                client.send(<span class="string">&#x27;Connection: close\n\n&#x27;</span>)</span><br><span class="line">                client.sendall(response)</span><br><span class="line">                client.close()</span><br><span class="line">        <span class="keyword">except</span> OSError <span class="keyword">as</span> e:</span><br><span class="line">                conn.close()</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;Connection closed&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>Run: Upload to ESP32, check IP via serial, access in browser. Refresh for updates.</p>
<p> Implementing WiFi networking introduced me to socket programming and IoT protocols. This extension demonstrated how sensors can integrate into connected systems, fueling my enthusiasm for wireless communications and embedded networking courses.</p>
<p><img src="https://minkai-shi.github.io/upload/geiger/web.png" alt="WiFi"></p>
<h2 id="MicroPython-with-Bluetooth-Connection"><a href="#MicroPython-with-Bluetooth-Connection" class="headerlink" title="MicroPython with Bluetooth Connection"></a>MicroPython with Bluetooth Connection</h2><p>From forum post: <a href="https://forum.eepw.com.cn/thread/382734/1">MicroPython实现DFRobot盖革模块与蓝牙连接</a></p>
<p>Integrated Bluetooth for phone connection. Use BLE app to connect to “Geiger_Counter” and receive real-time data.</p>
<p><strong>Code:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">DFrobot 盖革计数器实验</span></span><br><span class="line"><span class="string">接线说明：DFrobot Geiger模块--&gt;ESP32 IO</span></span><br><span class="line"><span class="string">         (D)--&gt;(14)</span></span><br><span class="line"><span class="string">         (+)--&gt;(5V)</span></span><br><span class="line"><span class="string">         (-)--&gt;(GND)</span></span><br><span class="line"><span class="string">         </span></span><br><span class="line"><span class="string">OLED(IIC)液晶模块--&gt;ESP32 IO</span></span><br><span class="line"><span class="string">         GND--&gt;(GND)</span></span><br><span class="line"><span class="string">         VCC--&gt;(5V)</span></span><br><span class="line"><span class="string">         SCL--&gt;(18)</span></span><br><span class="line"><span class="string">         SDA--&gt;(23)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment">#导入Pin模块</span></span><br><span class="line"><span class="keyword">from</span> machine <span class="keyword">import</span> Pin</span><br><span class="line"><span class="keyword">from</span> machine <span class="keyword">import</span> Timer</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> machine <span class="keyword">import</span> SoftI2C</span><br><span class="line"><span class="keyword">from</span> ssd1306 <span class="keyword">import</span> SSD1306_I2C  <span class="comment">#I2C的oled选该方法</span></span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep_ms</span><br><span class="line"><span class="keyword">import</span> bluetooth</span><br><span class="line">BLE_MSG = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="comment">#创建软件I2C对象</span></span><br><span class="line">i2c = SoftI2C(sda=Pin(<span class="number">23</span>), scl=Pin(<span class="number">18</span>))</span><br><span class="line"><span class="comment">#创建OLED对象，OLED分辨率、I2C接口</span></span><br><span class="line">oled = SSD1306_I2C(<span class="number">128</span>, <span class="number">64</span>, i2c) </span><br><span class="line"><span class="comment">#Geiger in</span></span><br><span class="line">Geiger_In=Pin(<span class="number">14</span>,Pin.IN,Pin.PULL_UP)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ESP32_BLE</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name</span>):</span><br><span class="line">        self.led = Pin(<span class="number">15</span>, Pin.OUT)</span><br><span class="line">        self.timer1 = Timer(<span class="number">0</span>)</span><br><span class="line">        self.name = name</span><br><span class="line">        self.ble = bluetooth.BLE()</span><br><span class="line">        self.ble.active(<span class="literal">True</span>)</span><br><span class="line">        self.ble.config(gap_name=name)</span><br><span class="line">        self.disconnected()</span><br><span class="line">        self.ble.irq(self.ble_irq)</span><br><span class="line">        self.register()</span><br><span class="line">        self.ble.gatts_write(self.rx, <span class="built_in">bytes</span>(<span class="number">100</span>))  <span class="comment">#修改一次最大接收字节数100</span></span><br><span class="line">        self.advertiser()</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">connected</span>(<span class="params">self</span>):</span><br><span class="line">        self.led.value(<span class="number">1</span>)</span><br><span class="line">        self.timer1.deinit()</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">disconnected</span>(<span class="params">self</span>):        </span><br><span class="line">        self.timer1.init(period=<span class="number">100</span>, mode=Timer.PERIODIC, callback=<span class="keyword">lambda</span> t: self.led.value(<span class="keyword">not</span> self.led.value()))</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">ble_irq</span>(<span class="params">self, event, data</span>):</span><br><span class="line">        <span class="keyword">global</span> BLE_MSG</span><br><span class="line">        <span class="keyword">if</span> event == <span class="number">1</span>:  <span class="comment">#_IRQ_CENTRAL_CONNECT 手机链接了此设备</span></span><br><span class="line">            self.connected()</span><br><span class="line">        <span class="keyword">elif</span> event == <span class="number">2</span>:  <span class="comment">#_IRQ_CENTRAL_DISCONNECT 手机断开此设备</span></span><br><span class="line">            self.advertiser()</span><br><span class="line">            self.disconnected()</span><br><span class="line">        <span class="keyword">elif</span> event == <span class="number">3</span>:  <span class="comment">#_IRQ_GATTS_WRITE 手机发送了数据 </span></span><br><span class="line">            buffer = self.ble.gatts_read(self.rx)</span><br><span class="line">            BLE_MSG = buffer.decode(<span class="string">&#x27;UTF-8&#x27;</span>).strip()</span><br><span class="line">            </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">register</span>(<span class="params">self</span>):        </span><br><span class="line">        service_uuid = <span class="string">&#x27;6E400001-B5A3-F393-E0A9-E50E24DCCA9E&#x27;</span></span><br><span class="line">        reader_uuid = <span class="string">&#x27;6E400002-B5A3-F393-E0A9-E50E24DCCA9E&#x27;</span></span><br><span class="line">        sender_uuid = <span class="string">&#x27;6E400003-B5A3-F393-E0A9-E50E24DCCA9E&#x27;</span></span><br><span class="line">        services = (</span><br><span class="line">            (</span><br><span class="line">                bluetooth.UUID(service_uuid), </span><br><span class="line">                (</span><br><span class="line">                    (bluetooth.UUID(sender_uuid), bluetooth.FLAG_NOTIFY), </span><br><span class="line">                    (bluetooth.UUID(reader_uuid), bluetooth.FLAG_WRITE),</span><br><span class="line">                )</span><br><span class="line">            ), </span><br><span class="line">        )</span><br><span class="line">        ((self.tx, self.rx,), ) = self.ble.gatts_register_services(services)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">send</span>(<span class="params">self, data</span>):</span><br><span class="line">        self.ble.gatts_notify(<span class="number">0</span>, self.tx, data + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">advertiser</span>(<span class="params">self</span>):</span><br><span class="line">        name = <span class="built_in">bytes</span>(self.name, <span class="string">&#x27;UTF-8&#x27;</span>)</span><br><span class="line">        adv_data = <span class="built_in">bytearray</span>(<span class="string">&#x27;\x02\x01\x02&#x27;</span>, <span class="string">&#x27;UTF-8&#x27;</span>) + <span class="built_in">bytearray</span>((<span class="built_in">len</span>(name) + <span class="number">1</span>, <span class="number">0x09</span>)) + name</span><br><span class="line">        self.ble.gap_advertise(<span class="number">100</span>, adv_data)</span><br><span class="line">        <span class="built_in">print</span>(adv_data)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\r\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#Geiger计数器外部中断函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Geiger_In_irq</span>(<span class="params">Geiger_In</span>):</span><br><span class="line">    <span class="keyword">global</span> numPulse</span><br><span class="line">    numPulse = numPulse + <span class="number">1</span></span><br><span class="line">    ble.send(str3)</span><br><span class="line"></span><br><span class="line"><span class="comment">#程序入口</span></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">global</span> numPulse</span><br><span class="line">    BUFFER_SIZE = <span class="number">20</span></span><br><span class="line">    rows, cols = <span class="number">2</span>, BUFFER_SIZE</span><br><span class="line">    mem_data = [[<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(cols)] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(rows)]</span><br><span class="line">    numPulse = <span class="number">0</span></span><br><span class="line">    pos = <span class="number">0</span>    </span><br><span class="line">    oled.fill(<span class="number">0</span>)  <span class="comment">#清空屏幕    </span></span><br><span class="line">    oled.text(<span class="string">&quot;Geiger Counter&quot;</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>)  <span class="comment">#显示字符串</span></span><br><span class="line">    oled.show()  <span class="comment">#执行显示</span></span><br><span class="line">    </span><br><span class="line">    ble = ESP32_BLE(<span class="string">&quot;Geiger_Counter&quot;</span>)    </span><br><span class="line">    </span><br><span class="line">    Geiger_In.irq(Geiger_In_irq,Pin.IRQ_FALLING)  <span class="comment">#配置外部中断，下降沿触发</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:  </span><br><span class="line">        time.sleep_ms(<span class="number">3000</span>)</span><br><span class="line">        mem_data[<span class="number">0</span>][pos] = time.ticks_ms()</span><br><span class="line">        mem_data[<span class="number">1</span>][pos] = numPulse</span><br><span class="line">        numPulse = <span class="number">0</span></span><br><span class="line">        cpm=<span class="number">0</span></span><br><span class="line">        pos_old = pos</span><br><span class="line">        pos = (pos+<span class="number">1</span>)%BUFFER_SIZE        </span><br><span class="line">        numAll = <span class="number">0</span></span><br><span class="line">        uSvh = <span class="number">0</span></span><br><span class="line">        time_now = mem_data[<span class="number">0</span>][pos_old] </span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, BUFFER_SIZE - <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> mem_data[<span class="number">0</span>][pos_old] != <span class="number">0</span>:</span><br><span class="line">                numAll = numAll + mem_data[<span class="number">1</span>][pos_old]</span><br><span class="line">                time_old = mem_data[<span class="number">0</span>][pos_old]</span><br><span class="line">                <span class="keyword">if</span> pos_old == <span class="number">0</span>:</span><br><span class="line">                    pos_old =  BUFFER_SIZE - <span class="number">1</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    pos_old = pos_old - <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> time_now-time_old &gt; <span class="number">0</span>:</span><br><span class="line">            cpm = numAll*<span class="number">1000</span>*<span class="number">60</span>/(time_now-time_old)</span><br><span class="line">            uSvh = cpm/<span class="number">151</span></span><br><span class="line">            </span><br><span class="line">        str1 = <span class="string">&quot;&#123;:.0f&#125;&quot;</span>.<span class="built_in">format</span>(cpm)    <span class="comment">#CPM转字符串</span></span><br><span class="line">        str2 = <span class="string">&quot;&#123;:.3f&#125;&quot;</span>.<span class="built_in">format</span>(uSvh)   <span class="comment">#uSv/h转字符串</span></span><br><span class="line">        oled.fill(<span class="number">0</span>)  <span class="comment">#清空屏幕</span></span><br><span class="line">        oled.text(<span class="string">&quot;Geiger Counter&quot;</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>)  <span class="comment">#显示字符串</span></span><br><span class="line">        oled.text(<span class="string">&quot;CPM&quot;</span>,<span class="number">80</span>,<span class="number">10</span>,<span class="number">2</span>)  <span class="comment">#显示CPM单位</span></span><br><span class="line">        oled.text(<span class="string">&quot;uSv/h&quot;</span>,<span class="number">80</span>,<span class="number">20</span>,<span class="number">2</span>)  <span class="comment">#显示uSv/h单位</span></span><br><span class="line">        oled.text(str1,<span class="number">0</span>,<span class="number">10</span>,<span class="number">2</span>)  <span class="comment">#显示CPM数据</span></span><br><span class="line">        oled.text(str2,<span class="number">0</span>,<span class="number">20</span>,<span class="number">2</span>)  <span class="comment">#显示uSv/h数据</span></span><br><span class="line">        oled.show()  <span class="comment">#执行显示</span></span><br><span class="line">        str3 = str1+<span class="string">&#x27; CPM  &#x27;</span>+str2+<span class="string">&#x27; uSv/h&#x27;</span></span><br><span class="line">        <span class="built_in">print</span>(str3)</span><br></pre></td></tr></table></figure>

<p>Run: Upload to ESP32. Use BLE debugger app on phone, connect to “Geiger_Counter”, select Unknown Service to receive data.</p>
<p> Adding Bluetooth expanded my knowledge of short-range wireless protocols. Managing BLE services and notifications challenged me to optimize power and data transfer.</p>
<p><img src="https://minkai-shi.github.io/upload/geiger/BLE1.jpg" alt="Bluetooth"><br><img src="https://minkai-shi.github.io/upload/geiger/BLE2.jpg" alt="Bluetooth"></p>
<h2 id="Conclusion-and-Reflections"><a href="#Conclusion-and-Reflections" class="headerlink" title="Conclusion and Reflections"></a>Conclusion and Reflections</h2><p>This project transformed a simple sensor module into a versatile radiation monitoring system, showcasing my ability to integrate hardware, software, and wireless technologies. Key learnings include interrupt-driven programming, data buffering for accuracy, and network integration. Challenges like voltage calibration and code optimization built my resilience and technical depth.</p>
<p>© 2024 [Minkai Shi]. Original content from EEPW forum. Hosted on GitHub.</p>
]]></content>
      <categories>
        <category>EEPW &amp; EEWorld Activity</category>
      </categories>
      <tags>
        <tag>EEPW &amp; EEWorld Activity</tag>
      </tags>
  </entry>
  <entry>
    <title>My Experience of Imperial College Summer School</title>
    <url>/2024/08/30/IC-SummerSchool/</url>
    <content><![CDATA[<p>&emsp;&emsp;I had an exciting time attending Imperial College London’s Summer School from 5-16 August 2024. I participated in the engineering group, and the whole summer school was mainly composed of four parts: introduction of each engineering major, master classes, group activities, and cultural and sports activities.<br>&emsp;&emsp;On the first day of summer school, The geology professor introduced us to the classification and composition of engineering, including electrical and electronic engineering, computer science, bio-pharmaceuticals, civil engineering, aerospace engineering, etc., involving knowledge in mathematics, physics, chemistry, biology, computers, earth sciences, and so on. Then she shared her relationship with engineering from the perspective of enlightenment learning and coaching. In the following study, we began to understand and experience various engineering majors.<br>1.Design engineering:Engineering Challenge<br>&emsp;&emsp;The design engineering student introduced the campus layout, followed by his own learning content about instrument modification. He also showed several examples of his work, such as a piano with permanent magnets replacing the hammer, a six-string pickup that relies entirely on electronics to adjust tone and pitch, and touchscreens on the keys for changing pitch. We were then asked to visualize an imagined sound and use the provided materials to make a model of an instrument that could produce it, explaining how it works. Finally, we connected the microcontroller, microphone, and speaker with wires under instructions to create a device that relies on vibrating the microphone to produce sound and reliably changes pitch by short-circuiting the contact points.<br>2.Civil Engineering: Designning a High Speed Railway Bridge<br>&emsp;&emsp;After the mentor explained the subject content, application scenarios, and employment situation, a railway bridge design case activity was conducted, which provided us with the local terrain, transportation, population and vegetation density, crop distribution, and flood risk map. It was required to limit the slope and transition radius to maintain maximum speed and minimize the impact on the local environment and residents. While saving materials and facilitating construction, it ensured survival rate in floods. In group collaboration, we focused on analyzing geological and cultural material factors, dividing tasks, mapping, making models, and preparing report content. At the beginning, we attempted to overlap all the terrain and affected areas onto the same map in order to avoid all of these areas and achieve the optimal route. But soon we found that it was difficult to achieve this ideal state in practical situations, as demonstrated in the case presented this time. We adjusted the plan to avoid the route as a supplement, and directly resolved the conflict between the railway bridge and the natural and cultural environment. For example, we increased the height of the bridge in narrow flood areas and used more steel bars in vegetation cultivation areas to ensure strength while reducing the damage and occupation of land by bridge piers.<br>3.Mechanical Engineering: Heavy Lifting Challenge<br>&emsp;&emsp;The supervisor explained the classification of the discipline and provided us with a visual experience of the architecture related categories through examples. Subsequently, we were given the materials to complete the task of making a crane model. During the process, continuous improvements were made to the structure to meet the requirements, but the final result was not ideal. The root cause was the lack of clear and explicit design, which led to the consumption of material durability due to constant modifications. At the same time, the structure was too complex and neglected the analysis of the essential principles, increasing the difficulty of production and the failure rate.<br>4.Aerospace Engineering: Learn how to think like an Aeronautical Engineer<br>&emsp;&emsp;The aerospace engineering class is taught by a structural and material engineering professor, who introduces the sub disciplines under this discipline, the courses to be completed, annual activities, and location arrangements. At the beginning of the visit, we were taken to the wind tunnel to understand its purpose and operating principle. We used force analysis, wind tunnel data, and relevant aerodynamic formulas to determine the error between theoretical resistance and actual experimental resistance on site. Subsequently, we visited the rocket, aircraft, control test flight laboratory, and flight test simulation equipment to understand the important parameters and stall causes of aircraft during flight, as well as solutions. In the 3D printing laboratory, we visited relevant facilities and our mentor introduced us to some energy-saving solutions for hollowing out large solid parts during printing, and asked us to complete the design of the structure and support with minimal consumables. Finally, the senior answered the students’ questions and solved their problems.<br>5.Earth Science Engineering: Space Misson Planning<br>&emsp;&emsp;In the class, we used given formulas to calculate the selection of fuel and weight in the Earth Moon and Moon Earth orbits, understands the three stages of the entire rocket mission, and listened to the professor’s research on asteroids.<br>6.Electronic and Electrical Engineering: Information Session<br>&emsp;&emsp;The professor explained to us the subjects and academic activities that college students need to learn every year, and showed us the results of one of the activities over the years. This was originally a major that I was very interested in, but it seems that I did not get enough understanding through the arrangement of the course, and the course time was very short.<br>7.Chemical Engineering: introduction to Chemical Engineering<br>&emsp;&emsp;At the Huxley Lecture Theatre, the mentor gave a lecture on the learning content arrangement of chemical engineering and the work content of chemists. Afterwards, we visited the school’s carbon capture experimental factory and its monitoring and control room, and learned about the functions and operations of the instruments. Returning to the auditorium, we experienced a digital experiment that simulated the control of high-temperature environments in the production process using computer programs. By adjusting the upper and lower limits of temperature control and heating power, we achieved the minimum energy consumption, low-temperature practice, and triggering of programs. Finally, the mentor led us to conduct a hydrogen explosion experiment and explained some common chemical knowledge in class and production life.<br>&emsp;&emsp;In the process of learning about various engineering majors, we also took 2 master classes, Master class 1: application score requirements, process timetable, pre-examination arrangement, some voluntary declaration mechanisms and misunderstandings, subject selection, etc. Master’s Course 2: Self awareness, Opportunity Awareness, Decision making, and Plan Implementation. We discussed the factors above that should be considered in the plans and combined with the university schedule, provided us with the execution time for each stage of the  employment plan in our discipline. This is very helpful for me to make a long-term study plan.<br>&emsp;&emsp;What impressed me was the ideation workshops. In the last three days, each academic group will be disrupted and reorganized. Each new group will observe and discover a pain point in their daily life, and then design products to solve it, while considering the target audience, product characteristics, and significance of existence. After determining the product, each group develops a production and testing process plan, sketches and models, and colleagues shoot advertisements and promote them. At the beginning of the group activity, the school explained how to find pain points and design products that fit the scene. Before the presentation, they introduced how to relax the whole body to ensure better speaking effectiveness.<br>&emsp;&emsp;In the early design stage of group collaboration, I provided suggestions for product structure design and assisted in drawing sketches. In the preparation stage of the report, I designed and drew the logo of the group company to participate in the shooting of the advertisement, and participated in the PPT presentation in the final report. My group mentor recommended foreign mapping software to me, and I learned the relevant operation tutorials myself. With my own exploration and creativity, I successfully completed the design task. On the morning of the presentation, a teacher specializing in performance explained the essentials of relaxing the whole body before a speech, how to maintain a natural and appropriate posture during the speech, and how to control breath and volume. The most important thing is to relax the whole body, stretch the neck and throat, and ensure that the vocal cords relax and produce natural sounds; The relaxation of shoulders and cervical spine makes the speech posture more upright and straight; Relax the limbs to make the coordination of movements and expressions smoother. My mentor personally led everyone to practice related relaxation exercises. During the group presentation that day, I put the speech skills I learned into practice.<br>&emsp;&emsp;In addition to this, we also held a lot of activities such as ten pin bowling, Thames cruises, theatre, bus tours, and trips to the beach in Brighton. We got together, met different people in the world, and experienced the unique scenery and culture of United Kingdom, which made summer school life full of joy.<br>&emsp;&emsp;Overall impression of Imperial College London and its engineering. There is no clear boundary between Imperial College London’s campus and society, and you can experience various customs and traditions. The ancient museum auditorium and the brand new modern teaching building are intertwined, reflecting the diversity and development of a country’s history. The precise and complete equipment and tools in the laboratory building, as well as rigorous and serious rules and regulations, ensure that subject learning and scientific research activities can be carried out safely, standardly, and efficiently. The professor’s knowledge is beyond doubt, and as a mentor, the students in school are also enthusiastic and patient, with excellent academic abilities. Our life mentor is an outgoing and enthusiastic young man, with an African style hairstyle and a habit of patting the forehead, making him particularly prominent among the group gathering. For students from non English speaking countries, he is very tolerant and patiently guides them to participate in everyone’s English communication. During some driving or waiting times, he also enlivens the atmosphere, organizing everyone to play games or sing.<br>&emsp;&emsp;During the summer school period, I gained a deeper understanding of the engineering major, which is a comprehensive application of mathematics and physics, including many specific applications and combinations in subdivided fields. It is a discipline that applies theoretical knowledge such as mathematics, physics, chemistry, geology, and astronomy to daily life and production. In addition to proficient application of mathematical knowledge, this subject also requires us to have the observation ability to discover opportunities for knowledge application in life, the creativity to associate design solutions, and the execution ability to solve practical problems.<br>&emsp;&emsp;After attending the summer school, I felt that I require new requirements and goals for my self-development.<br>&emsp;&emsp;First, Oral expression still needs improvement, as I was unable to fully express my ideas in a timely and clear manner during group activities.<br>&emsp;&emsp;Second, In terms of daily life, I have not fully utilized the substitute items and clothing. In the future, I need to train and organize the use of items to enhance my storage ability.<br>&emsp;&emsp;Third, Culturally, I need to understand and respect local customs and religions, and try local entertainment projects appropriately in order to integrate into the collective.<br>&emsp;&emsp;Last, In terms of subjects, I will conduct in-depth exploration and research in various fields of interest to ensure that I have sufficient advance knowledge of the university subjects I am interested in.<br><img src="/upload/IC1.jpg" alt="IC1" title="IC1"><br><img src="/upload/IC2.jpg" alt="IC2" title="IC2"><br><img src="/upload/IC3.jpg" alt="IC3" title="IC3"><br><img src="/upload/IC4.jpg" alt="IC4" title="IC4"><br><img src="/upload/IC5.jpg" alt="IC5" title="IC5"><br><img src="/upload/IC6.jpg" alt="IC6" title="IC6"><br><img src="/upload/IC7.jpg" alt="IC7" title="IC7"></p>
]]></content>
      <categories>
        <category>IC Summer School</category>
      </categories>
      <tags>
        <tag>IC Summer School</tag>
      </tags>
  </entry>
  <entry>
    <title>Making Pilot 743Pen tip suitable in Chinese made vacuum filler pen body</title>
    <url>/2024/06/28/MakingPilot743Pen/</url>
    <content><![CDATA[<p>Making Pilot 743Pen tip suitable in Chinese made vacuum filler pen body .<br>Remove the pen tip and tongue from the original pen for later use. The pen tip can be self polished and electroplated to make it look better. Choose a domestically produced pen holder of the same size and size as the 35th model. Remove the nib and tongue of the pen, and groove them on both sides of the back of the tongue to fit the 743 nib positioning buckle. Polish the surface curvature to attach the alloy plate to ensure normal use. After polishing, clean the plastic particles on the tongue to ensure fine and clean bristles. Use a blade to expand the ink guide groove and reinstall the nib together, and then fine tune them together.That’s all.<br><img src="/upload/Pilot1.jpg" alt="pic1" title="pic1"></p>
]]></content>
      <categories>
        <category>pen</category>
      </categories>
      <tags>
        <tag>pen</tag>
      </tags>
  </entry>
  <entry>
    <title>Power_Monitoring_System</title>
    <url>/2025/07/20/Power_Monitoring_System/</url>
    <content><![CDATA[<h1 id="Bluetooth-Power-Monitoring-System-with-ESP32-and-MicroPython"><a href="#Bluetooth-Power-Monitoring-System-with-ESP32-and-MicroPython" class="headerlink" title="Bluetooth Power Monitoring System with ESP32 and MicroPython"></a>Bluetooth Power Monitoring System with ESP32 and MicroPython</h1><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>When browsing EEPW in March, I was instantly drawn to the <a href="https://www.eepw.com.cn/event/action/digikey/diy_2025_first.html">“DigiKey DIY Power Monitoring and Control System”</a> event for 2025. Unfortunately, it coincided with my A-level final exams, leaving me no time to participate. After exams, seeing others’ projects sparked my determination to build my own version.  </p>
<p>Using an ESP32 and MicroPython, I created a system that measures voltage, current, active&#x2F;reactive power, and transmits data via Bluetooth. Surprisingly, it’s practical for real applications like smart plug monitoring - proving textbook electrical theory can become tangible tools.</p>
<p><strong>引言</strong><br>记得三月刷EEPW网站时，一眼就盯上了”2025年第1期——DigiKey陪你渡过春夏秋冬”活动里的DIY功率监测与控制系统。可惜当时正赶上ALEVEL期末大考，每天被试卷淹没，根本没时间报名。等大考结束，看着活动页面里别人分享的作品，心里直痒痒——既然错过了官方活动，不如自己动手复刻一个？</p>
<p>于是我抱着”不能浪费假期”的想法，翻出家里的ESP32开发板，决定用MicroPython实现这个功能。我的目标很简单：让这个小东西能测家里插座的电压、电流，算出有功功率、无功功率这些物理课上听过的参数，再通过蓝牙传到手机上实时看数据。没想到折腾下来，它居然真能用到智能插座监测、分析电器耗电情况上——原来课本里的电学知识，真的能变成手里会干活的工具。</p>
<h2 id="Technical-Implementation"><a href="#Technical-Implementation" class="headerlink" title="Technical Implementation"></a>Technical Implementation</h2><p>The system adopts a <strong>1kHz sampling rate</strong> for 50Hz AC signal acquisition (each grid cycle corresponds to 20 samples), with core optimization focused on solving two critical issues: MicroPython’s efficiency bottleneck and poor data stability caused by interference. Key components include:</p>
<ul>
<li><strong>Voltage measurement</strong>: GPIO34 (12-bit ADC, signal scaled via voltage transformer)</li>
<li><strong>Current measurement</strong>: GPIO39 (12-bit ADC, current sensor signal conversion)</li>
<li><strong>Recursive DFT (RDFT)</strong>: Custom-implemented algorithm with O(1) per-sample complexity, addressing MicroPython’s efficiency limitations</li>
<li><strong>Relay control</strong>: GPIO2 with overload protection</li>
<li><strong>BLE Service</strong>: Custom power monitoring service with multiple characteristics</li>
</ul>
<p><strong>技术实现</strong><br>系统采用递归傅里叶变换进行高效信号处理，采样率为1kHz。关键组件包括：</p>
<ul>
<li><strong>电压测量</strong>：GPIO34</li>
<li><strong>电流测量</strong>：GPIO39</li>
<li><strong>递归DFT</strong>：每个样本O(1)常数复杂度</li>
<li><strong>继电器控制</strong>：GPIO2，带过载保护</li>
<li><strong>BLE服务</strong>：定制电力监测服务，支持多个特性</li>
</ul>
<h3 id="Core-Algorithm-Recursive-Fourier-Transform-RDFT-——-Targeted-Solution-to-MicroPython’s-Efficiency-Bottleneck"><a href="#Core-Algorithm-Recursive-Fourier-Transform-RDFT-——-Targeted-Solution-to-MicroPython’s-Efficiency-Bottleneck" class="headerlink" title="Core Algorithm: Recursive Fourier Transform (RDFT) —— Targeted Solution to MicroPython’s Efficiency Bottleneck"></a>Core Algorithm: Recursive Fourier Transform (RDFT) —— Targeted Solution to MicroPython’s Efficiency Bottleneck</h3><h4 id="Algorithm-Design-Basis"><a href="#Algorithm-Design-Basis" class="headerlink" title="Algorithm Design Basis"></a>Algorithm Design Basis</h4><p>To address MicroPython’s low efficiency, the recursive Fourier transform was adopted to replace conventional algorithms (FFT, standard DFT, moving average). The core advantages are:</p>
<ol>
<li><strong>Real-time computation</strong>: Updates frequency domain coefficients immediately upon receiving a new sample, avoiding batch processing delays of FFT&#x2F;DFT.</li>
<li><strong>Ultra-low complexity</strong>: Reduces per-sample computation complexity from O(N) (standard DFT) to O(1), perfectly matching MicroPython’s hardware constraints.</li>
<li><strong>Grid frequency adaptation</strong>: Precisely locks the 50Hz fundamental frequency, ensuring accuracy while maintaining real-time performance.</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Recursive DFT implementation</span></span><br><span class="line">omega = <span class="number">2</span> * math.pi * <span class="number">50</span> / <span class="number">1000</span></span><br><span class="line">cos_omega = math.cos(omega)</span><br><span class="line">sin_omega = math.sin(omega)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">update_dft</span>(<span class="params">sample, old_sample, a, b</span>):</span><br><span class="line">    delta = sample - old_sample</span><br><span class="line">    temp_a = a + delta</span><br><span class="line">    a_new = cos_omega * temp_a - sin_omega * b</span><br><span class="line">    b_new = sin_omega * temp_a + cos_omega * b</span><br><span class="line">    <span class="keyword">return</span> a_new, b_new</span><br><span class="line"></span><br><span class="line"><span class="comment"># Voltage processing</span></span><br><span class="line">V_a, V_b = update_dft(voltage_sample, old_sample_v, V_a, V_b)</span><br><span class="line">V_amplitude = math.sqrt(V_a ** <span class="number">2</span> + V_b ** <span class="number">2</span>) * VOLTAGE_SCALE / N</span><br></pre></td></tr></table></figure>

<h3 id="Relay-Control-Logic"><a href="#Relay-Control-Logic" class="headerlink" title="Relay Control Logic"></a>Relay Control Logic</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Overload protection</span></span><br><span class="line"><span class="keyword">if</span> I_amplitude &gt; <span class="number">1</span>:  <span class="comment"># 1A threshold</span></span><br><span class="line">    relay_pin.value(<span class="number">0</span>)  <span class="comment"># Cut power</span></span><br><span class="line">    </span><br><span class="line"><span class="comment"># Timed activation via BLE</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ble_handler</span>(<span class="params">event, data</span>):</span><br><span class="line">    <span class="keyword">if</span> event == ubluetooth.IRQ_GATTS_WRITE:</span><br><span class="line">        duration = struct.unpack(<span class="string">&#x27;&lt;f&#x27;</span>, value)[<span class="number">0</span>]  <span class="comment"># Duration in seconds</span></span><br><span class="line">        relay_pin.value(<span class="number">1</span>)</span><br><span class="line">        relay_timer.init(period=<span class="built_in">int</span>(duration*<span class="number">1000</span>), callback=turn_off_relay)</span><br></pre></td></tr></table></figure>

<h2 id="Key-Features"><a href="#Key-Features" class="headerlink" title="Key Features"></a>Key Features</h2><ol>
<li><p><strong>Real-time Power Monitoring</strong></p>
<ul>
<li>1kHz sampling rate, &lt;20ms data update latency (meets real-time requirements for 50Hz grid)</li>
<li>RDFT algorithm reduces computation complexity from O(N) to O(1), breaking through MicroPython’s efficiency bottleneck</li>
</ul>
</li>
<li><p><strong>Intelligent Protection</strong></p>
<ul>
<li>Automatic shutdown when current &gt;1A</li>
<li>BLE-controlled timed activation</li>
<li>Visual indicator (GPIO15 LED)</li>
</ul>
</li>
<li><p><strong>Wireless Connectivity</strong></p>
<ul>
<li>Standard BLE power service (0xFFF0)</li>
<li>Multiple characteristics for all parameters</li>
<li>Control interface for remote operation</li>
</ul>
</li>
</ol>
<p><strong>核心功能</strong>  </p>
<ol>
<li><p><strong>实时电力监测</strong></p>
<ul>
<li>1kHz采样率，&lt;20ms数据更新延迟（匹配50Hz电网实时性需求）</li>
<li>递归DFT算法将计算复杂度从O(N)降至O(1)，突破MicroPython效率瓶颈</li>
</ul>
</li>
<li><p><strong>智能保护</strong></p>
<ul>
<li>电流&gt;1A时自动断电</li>
<li>BLE控制定时激活</li>
<li>视觉指示器(GPIO15 LED)</li>
</ul>
</li>
<li><p><strong>无线连接</strong></p>
<ul>
<li>标准BLE电力服务(0xFFF0)</li>
<li>多参数特性支持</li>
<li>远程操作控制接口</li>
</ul>
</li>
</ol>
<h2 id="Electrical-Engineering-Concepts"><a href="#Electrical-Engineering-Concepts" class="headerlink" title="Electrical Engineering Concepts"></a>Electrical Engineering Concepts</h2><p>This project transformed textbook theories into practical insights:  </p>
<table>
<thead>
<tr>
<th><strong>Concept</strong></th>
<th><strong>Theory</strong></th>
<th><strong>Implementation</strong></th>
</tr>
</thead>
<tbody><tr>
<td>Analog-Digital Conversion</td>
<td>Converts continuous signals to discrete values via sampling rate &amp; resolution</td>
<td>Used ESP32’s 12-bit ADC (4096 levels) with scaling factors for signal recovery</td>
</tr>
<tr>
<td>Recursive Fourier Transform</td>
<td>Efficient frequency component calculation with O(1) complexity</td>
<td>Implemented rotating factor update for real-time 50Hz component extraction</td>
</tr>
<tr>
<td>Power Theory</td>
<td>Active power performs work; reactive power circulates; PF&#x3D;active&#x2F;apparent</td>
<td>Calculated P, Q, S from voltage&#x2F;current phase relationships</td>
</tr>
<tr>
<td>Relay Control</td>
<td>Electromechanical switching for circuit protection</td>
<td>GPIO-based control with overload protection and timed activation</td>
</tr>
</tbody></table>
<p><strong>电气工程原理</strong><br>本项目将教科书理论转化为实践洞察：</p>
<table>
<thead>
<tr>
<th><strong>概念</strong></th>
<th><strong>理论</strong></th>
<th><strong>实现</strong></th>
</tr>
</thead>
<tbody><tr>
<td>模数转换</td>
<td>通过采样率和分辨率将连续信号转换为离散值</td>
<td>使用ESP32的12位ADC(4096级)配合缩放因子恢复信号</td>
</tr>
<tr>
<td>递归傅里叶变换</td>
<td>O(1)复杂度的高效频率分量计算</td>
<td>采用旋转因子更新实时提取50Hz分量</td>
</tr>
<tr>
<td>功率理论</td>
<td>有功功率做功；无功功率循环；功率因数&#x3D;有功&#x2F;视在</td>
<td>根据电压&#x2F;电流相位关系计算P、Q、S</td>
</tr>
<tr>
<td>继电器控制</td>
<td>用于电路保护的机电开关</td>
<td>基于GPIO的控制，带过载保护和定时激活功能</td>
</tr>
</tbody></table>
<h2 id="Development-Challenges"><a href="#Development-Challenges" class="headerlink" title="Development Challenges"></a>Development Challenges</h2><ol>
<li><p><strong>ADC Calibration</strong><br>Initial voltage readings had 10% error due to incorrect scaling. Calibration against multimeter measurements resolved this.</p>
</li>
<li><p><strong>Real-time Processing</strong><br>The recursive DFT implementation required careful buffer management to prevent ESP32 crashes.</p>
</li>
<li><p><strong>BLE Reliability</strong><br>Interference near WiFi routers caused disconnections. Solution: Optimized data packing and transmission intervals.</p>
</li>
<li><p><strong>Relay Timing Accuracy</strong><br>Microsecond-level precision was needed for overload protection. Achieved through hardware-timer callbacks.</p>
</li>
</ol>
<p><strong>开发挑战</strong>  </p>
<ol>
<li><p><strong>ADC校准</strong><br>初始电压读数存在10%误差，通过万用表校准缩放因子解决</p>
</li>
<li><p><strong>实时处理</strong><br>递归DFT实现需要精细的缓冲区管理以防止ESP32崩溃</p>
</li>
<li><p><strong>BLE可靠性</strong><br>WiFi路由器附近存在干扰，通过优化数据打包和传输间隔解决</p>
</li>
<li><p><strong>继电器时序精度</strong><br>过载保护需要微秒级精度，通过硬件定时器回调实现</p>
</li>
</ol>
<h2 id="Applications"><a href="#Applications" class="headerlink" title="Applications"></a>Applications</h2><ol>
<li><p><strong>Home Energy Monitoring</strong>  </p>
<ul>
<li>Appliance-level power consumption tracking</li>
<li>Peak demand identification</li>
</ul>
</li>
<li><p><strong>Industrial Equipment Protection</strong>  </p>
<ul>
<li>Motor overload prevention</li>
<li>Predictive maintenance</li>
</ul>
</li>
<li><p><strong>Smart Grid Research</strong>  </p>
<ul>
<li>Power quality analysis</li>
<li>Load behavior studies</li>
</ul>
</li>
<li><p><strong>Educational Demonstrations</strong>  </p>
<ul>
<li>Power theory visualization</li>
<li>Embedded systems programming</li>
</ul>
</li>
</ol>
<p><strong>应用场景</strong>  </p>
<ol>
<li><p><strong>家庭能源监控</strong>  </p>
<ul>
<li>设备级功耗跟踪</li>
<li>峰值需求识别</li>
</ul>
</li>
<li><p><strong>工业设备保护</strong>  </p>
<ul>
<li>电机过载预防</li>
<li>预测性维护</li>
</ul>
</li>
<li><p><strong>智能电网研究</strong>  </p>
<ul>
<li>电能质量分析</li>
<li>负载行为研究</li>
</ul>
</li>
<li><p><strong>教学演示</strong>  </p>
<ul>
<li>功率理论可视化</li>
<li>嵌入式系统编程</li>
</ul>
</li>
</ol>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>This project focuses on solving two core pain points in ESP32+MicroPython power monitoring systems: <strong>MicroPython’s efficiency bottleneck</strong> and <strong>poor data stability under grid interference</strong>. The key innovations are:</p>
<ol>
<li>Targeted adoption of recursive Fourier transform (RDFT) to break through MicroPython’s computational limitations — reducing complexity from O(N) to O(1) enables real-time 50Hz fundamental frequency extraction, which conventional algorithms cannot achieve.</li>
<li>Synergistic optimization of 10-cycle extended data window and RDFT — smoothing interference while maintaining real-time performance, reducing data fluctuation from ±5% to ±1%.</li>
</ol>
<p>The system proves that low-cost embedded platforms can deliver professional-grade power monitoring performance through algorithm optimization and hardware-software synergy. Future enhancements will include:</p>
<ul>
<li>WiFi integration for cloud data logging and remote access via mobile apps.</li>
<li>Expansion of RDFT to support harmonic analysis (2nd~13th harmonics) for comprehensive power quality evaluation.</li>
<li>Machine learning-based load identification (classifying appliances via unique power consumption signatures).</li>
</ul>
<p><strong>结论</strong><br>本项目聚焦解决ESP32+MicroPython电力监测系统的两大核心痛点：<strong>MicroPython效率瓶颈</strong>与<strong>电网干扰下的数据稳定性差</strong>。关键创新点在于：</p>
<ol>
<li>针对性采用递归傅里叶变换（RDFT）突破MicroPython计算限制——将复杂度从O(N)降至O(1)，实现常规算法无法完成的50Hz基波实时提取。</li>
<li>10周期扩展数据窗与RDFT协同优化——在平滑干扰的同时保持实时性，数据波动从±5%降至±1%。</li>
</ol>
<p>项目验证了：通过算法优化与软硬件协同，低成本嵌入式平台可实现专业级电力监测性能。未来优化方向包括：</p>
<ul>
<li>集成WiFi功能，支持云数据日志与手机APP远程访问。</li>
<li>扩展RDFT算法至2~13次谐波分析，实现全面电能质量评估。</li>
<li>引入机器学习实现负载识别（通过独特功耗特征分类电器类型）。</li>
</ul>
<p><img src="/upload/Power1.jpg" alt="Hardware Assembly"><br><img src="/upload/Power2.jpg" alt="Debug"><br><img src="/upload/Power3.jpg" alt="Debug"> </p>
]]></content>
      <categories>
        <category>EEPW &amp; EEWorld Activity</category>
      </categories>
      <tags>
        <tag>EEPW &amp; EEWorld Activity</tag>
      </tags>
  </entry>
  <entry>
    <title>Sheaffer&#39;s Snorkel Pen Filling Structure Renew</title>
    <url>/2024/04/28/Sheaffer-Snorkel-Pen-Renew/</url>
    <content><![CDATA[<p>Sheaffer’s Snorkel Pen Filling Structure Renew </p>
<ol>
<li>Assembly sealing gasket: Unscrew the pen tip assembly, unscrew the breathing tube and take out the aging gasket, remove it and put on a new gasket</li>
<li>Water dispenser assembly: Unscrew the pen holder, remove the water dispenser assembly from the pen holder end, use a screwdriver to completely push out the connector and aging ink cartridge from the small hole at the tail, clean and soak in hot water, remove the ink cartridge connection key and the insect glue that fixes the breathing tube, put on a new ink cartridge, and fix it with insect glue. Remove the breathing tube and clean the ink guide strip before reinstalling it in its original state<br><img src="/upload/Sheaffer1.jpg" alt="pic1" title="pic1"></li>
<li>With a long straight screwdriver, unscrew the tail button screw, push out the TD tube from the pen holder, pick out the aging O-ring with a toothpick, clean the exhaust hole O-ring groove, apply a little glue, and use a toothpick to fully insert the new O-ring into the O-ring groove. When installing the tail button, replace the screw hole sealing gasket, and finally reinstall it in its original state</li>
<li>Overall: Finally, apply lubricating oil to the threads of the water assembly, and also apply silicone oil to other threads to prevent water and air leakage.<br><img src="/upload/Sheaffer2.jpg" alt="pic2" title="pic2"></li>
</ol>
]]></content>
      <categories>
        <category>pen</category>
      </categories>
      <tags>
        <tag>pen</tag>
      </tags>
  </entry>
  <entry>
    <title>Sheaffer&#39;s vaccum filling structure renew</title>
    <url>/2024/06/26/Sheaffer-vaccum-Renew/</url>
    <content><![CDATA[<p>Sheaffer’s vaccum filling structure renew , soaked in hot water at around 60 degrees Celsius to dissolve the tail seal insect glue. After tightening the tail button, continue to rotate clockwise to remove the tail seal. Unscrew the hard rubber screw on the piston head, clean the gap between the pen rod piston head and the original rubber of the tail seal, replace with a new piston plate, and reinstall the original tail seal sample. If the tail seal thread cannot be fixed by friction and becomes loose, stick it with insect glue<br><img src="/upload/Sheaffer3.jpg" alt="pic3" title="pic3"></p>
]]></content>
      <categories>
        <category>pen</category>
      </categories>
      <tags>
        <tag>pen</tag>
      </tags>
  </entry>
  <entry>
    <title>Snake Game Activity-1</title>
    <url>/2024/09/16/Snake_Game_Activity-1/</url>
    <content><![CDATA[<h1 id="Snake-Game-Activity-1"><a href="#Snake-Game-Activity-1" class="headerlink" title="Snake Game Activity-1"></a>Snake Game Activity-1</h1><p>The <strong>“Let’s do Activity”</strong> is a year-long campaign initiated by DigiKey and EEPW, titled <strong>“Learn Technology with E-Classroom, Complete Tasks for Rebates.”</strong> In 2024, there will be 4 sessions. Each session features technical experts recommending development boards&#x2F;instrument kits with strong playability and educational value, guiding participants through hands-on practice. The activity aims to help electronics enthusiasts learn practical technical knowledge, accumulate DIY experience, and become better versions of themselves!</p>
<p>I participated in the <strong>Snake Game Activity</strong> of the <strong>2nd session</strong> of “Let’s do Activity.” Within the specified timeframe, participants place orders through the exclusive “DigiKey Purchase” link on the DigiKey official website. By completing basic tasks explained by instructors, they can receive a rebate on their order costs.</p>
<p><strong>Highlights of This Session</strong>:<br>Implementing the Snake Game using <strong>Raspberry Pi Pico</strong>.</p>
<p><strong>Activity Page</strong>:<br><a href="https://www.eepw.com.cn/event/action/digikey/diy_sec.html">https://www.eepw.com.cn/event/action/digikey/diy_sec.html</a></p>
<p>As a high school student participating for the first time, I carefully selected products to meet requirements without exceeding the budget.</p>
<p><strong>Provided Components</strong>:</p>
<p><strong>Core Components (for basic tasks)</strong>:</p>
<ul>
<li><strong>Raspberry Pi Pico</strong> - ARM® Cortex®-M0+ MCU 32-bit Evaluation Board - SC0917 (Required)</li>
<li><strong>Raspberry Pi Pico Evaluation Expansion Board</strong> - PIM543 - RP2040 LCD 1.14” Display (Choose 1 of 3)</li>
<li><strong>Raspberry Pi Pico Evaluation Expansion Board</strong> - PIM580 - LCD 2” Display (Choose 1 of 3)</li>
<li><strong>Raspberry Pi Pico Evaluation Expansion Board</strong> - 103030400 - ST7789 LCD 1.14” Display (Choose 1 of 3)</li>
</ul>
<p><strong>Extended Components (for advanced tasks)</strong>:</p>
<ul>
<li><strong>Transistor</strong> - SS8550DTA - PNP Bipolar (BJT) 25 V 1.5 A 200MHz 1 W Through-Hole TO-92-3</li>
<li><strong>Speaker</strong> - OWS-1330TA-8 - 8Ω General Speaker 500 mW 100 Hz~20 kHz Top Round</li>
</ul>
<p>Among the three screens, two had smaller sizes and resolutions (1.14”). The <strong>PIM580 PIOO DISPLAY PACK 2.0</strong> was larger but had tiny directional buttons, which made it unsuitable for game development. I chose the <strong>103030400</strong> model with directional buttons. Its display quality is decent, though limited in content capacity due to the small size. Additionally, I purchased a <strong>PIOO OMNIBUS (DUAL EXPANDER)</strong> board for the Pico. This dual expansion board is highly practical—after connecting the screen, the remaining slot allowed me to freely add components. For this project, I used it to connect a speaker without soldering.</p>
<p>The screen uses the <strong>Waveshare Pico-LCD-1.14</strong> module. Waveshare provides official drivers and pre-ported LVGL driver examples, making development straightforward.<br><img src="/upload/snake1-1.jpg" alt="snake1-1" title="snake1-1"><br><img src="/upload/snake1-2.jpg" alt="snake1-2" title="snake1-2"><br><strong>My EEPW Forum Post</strong>:<br><a href="https://forum.eepw.com.cn/thread/384440/1">https://forum.eepw.com.cn/thread/384440/1</a></p>
]]></content>
      <categories>
        <category>EEPW &amp; EEWorld Activity</category>
      </categories>
      <tags>
        <tag>EEPW &amp; EEWorld Activity</tag>
      </tags>
  </entry>
  <entry>
    <title>Snake Game Activity-2</title>
    <url>/2024/09/29/Snake_Game_Activity-2/</url>
    <content><![CDATA[<h1 id="Snake-Game-Activity-2"><a href="#Snake-Game-Activity-2" class="headerlink" title="Snake Game Activity-2"></a>Snake Game Activity-2</h1><h1 id="Colorful-Snake-Game-on-Raspberry-Pi-Pico-Development-Process-Achievements"><a href="#Colorful-Snake-Game-on-Raspberry-Pi-Pico-Development-Process-Achievements" class="headerlink" title="Colorful Snake Game on Raspberry Pi Pico: Development Process &amp; Achievements"></a>Colorful Snake Game on Raspberry Pi Pico: Development Process &amp; Achievements</h1><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><h2 id="This-project-was-part-of-the-“Let’s-Do-Activity”-Session-2-organized-by-DigiKey-and-EEPW-focusing-on-developing-a-Snake-Game-using-the-Raspberry-Pi-Pico-microcontroller-The-goal-was-to-implement-core-game-mechanics-integrate-a-custom-GUI-with-LVGL-and-add-personalized-audio-effects-using-PWM-driven-speakers-Below-I-detail-my-journey-through-hardware-setup-software-development-and-creative-customization-This-project-was-awarded-the-EEPW-Excellence-Prize-for-its-innovative-integration-of-embedded-systems-recognized-for-technical-rigor-This-project-won-the-Excellence-Prize-of-Electronic-Engineering-World-EEPW-for-its-innovative-technical-implementation-The-prize-is-a-200-yuan-JD-com-e-voucher"><a href="#This-project-was-part-of-the-“Let’s-Do-Activity”-Session-2-organized-by-DigiKey-and-EEPW-focusing-on-developing-a-Snake-Game-using-the-Raspberry-Pi-Pico-microcontroller-The-goal-was-to-implement-core-game-mechanics-integrate-a-custom-GUI-with-LVGL-and-add-personalized-audio-effects-using-PWM-driven-speakers-Below-I-detail-my-journey-through-hardware-setup-software-development-and-creative-customization-This-project-was-awarded-the-EEPW-Excellence-Prize-for-its-innovative-integration-of-embedded-systems-recognized-for-technical-rigor-This-project-won-the-Excellence-Prize-of-Electronic-Engineering-World-EEPW-for-its-innovative-technical-implementation-The-prize-is-a-200-yuan-JD-com-e-voucher" class="headerlink" title="This project was part of the “Let’s Do Activity” (Session 2) organized by DigiKey and EEPW, focusing on developing a Snake Game using the Raspberry Pi Pico microcontroller. The goal was to implement core game mechanics, integrate a custom GUI with LVGL, and add personalized audio effects using PWM-driven speakers. Below, I detail my journey through hardware setup, software development, and creative customization.This project was awarded the EEPW Excellence Prize for its innovative integration of embedded systems, recognized for technical rigor.This project won the Excellence Prize of Electronic Engineering World (EEPW) for its innovative technical implementation. The prize is a 200-yuan JD.com e-voucher."></a>This project was part of the <a href="https://www.eepw.com.cn/event/action/digikey/diy_sec.html">“Let’s Do Activity” (Session 2)</a> organized by DigiKey and EEPW, focusing on developing a <em>Snake Game</em> using the <strong>Raspberry Pi Pico</strong> microcontroller. The goal was to implement core game mechanics, integrate a custom GUI with LVGL, and add personalized audio effects using PWM-driven speakers. Below, I detail my journey through hardware setup, software development, and creative customization.This project was awarded the <strong>EEPW Excellence Prize</strong> for its innovative integration of embedded systems, recognized for technical rigor.<br>This project won the Excellence Prize of Electronic Engineering World (EEPW) for its innovative technical implementation. The prize is a 200-yuan JD.com e-voucher.</h2><h2 id="Hardware-Setup"><a href="#Hardware-Setup" class="headerlink" title="Hardware Setup"></a>Hardware Setup</h2><h3 id="Core-Components"><a href="#Core-Components" class="headerlink" title="Core Components"></a>Core Components</h3><ul>
<li><strong>Raspberry Pi Pico</strong> (ARM Cortex-M0+ MCU)  </li>
<li><strong>Waveshare Pico-LCD-1.14</strong> (1.14” LCD with directional buttons)  </li>
<li><strong>PIOO Omnibus (Dual Expander Board)</strong> for extended I&#x2F;O  </li>
<li><strong>8Ω Speaker</strong> connected via PWM for audio effects</li>
</ul>
<p><strong>System Architecture</strong><br>The Pico was mounted on the Dual Expander Board’s central slot. The LCD occupied <strong>Deck 1</strong>, while <strong>Deck 2</strong> hosted the speaker via GPIO 27 (PWM output).<br><img src="http://uphotos.eepw.com.cn/1713930123/pics/1724036918676284.png" alt="System Diagram"></p>
<hr>
<h2 id="Software-Development"><a href="#Software-Development" class="headerlink" title="Software Development"></a>Software Development</h2><h3 id="Toolchain-Setup"><a href="#Toolchain-Setup" class="headerlink" title="Toolchain Setup"></a>Toolchain Setup</h3><p>Initially, I struggled with Keil MDK due to licensing and compilation issues. After days of troubleshooting, I switched to the <strong>official Pico SDK</strong> with <strong>VS Code</strong> and <strong>Visual Studio 2022</strong>, following these steps:  </p>
<ol>
<li><p>Install <strong>Pico C&#x2F;C++ SDK</strong>, CMake, and VS Code.  </p>
</li>
<li><p>Configure <code>PICO_SDK_PATH</code> in the developer PowerShell.  </p>
</li>
<li><p>Compile code using:  </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> build &amp;&amp; <span class="built_in">cd</span> build  </span><br><span class="line">cmake -G <span class="string">&quot;NMake Makefiles&quot;</span> ..  </span><br><span class="line">nmake  </span><br></pre></td></tr></table></figure>
</li>
<li><p>Flashed the generated <code>.uf2</code> file to the Pico.</p>
</li>
</ol>
<h3 id="LVGL-Integration-for-GUI"><a href="#LVGL-Integration-for-GUI" class="headerlink" title="LVGL Integration for GUI"></a>LVGL Integration for GUI</h3><p>The <strong>Waveshare LCD</strong> utilized LVGL (Light and Versatile Graphics Library) with optimizations:</p>
<p>DMA Transfers: Reduced CPU usage to <strong>&lt;35%</strong> by offloading SPI data transfer.</p>
<ul>
<li><strong>Double Buffering</strong>: Ensured smooth animations by rendering in one buffer while transferring another.</li>
<li><strong>Custom Widgets</strong>: Designed four interactive pages:<ul>
<li><strong>Splash Screen</strong>: Displays the game logo.</li>
<li><strong>Level Selection</strong>: Allows users to choose difficulty (Level 1-8).</li>
<li><strong>Gameplay Interface</strong>: Renders the snake, food, and collision logic.</li>
<li><strong>Results Page</strong>: Shows scores and game-over messages.</li>
</ul>
</li>
</ul>
<h3 id="Game-Logic-Implementation"><a href="#Game-Logic-Implementation" class="headerlink" title="Game Logic Implementation"></a>Game Logic Implementation</h3><h4 id="Key-Features"><a href="#Key-Features" class="headerlink" title="Key Features"></a>Key Features</h4><ol>
<li><strong>Movement Mechanics</strong><ul>
<li>Directional constraints: Vertical movement allows only horizontal turns, and vice versa.</li>
</ul>
</li>
<li><strong>Speed Scaling</strong><ul>
<li>Progressive difficulty: From 300ms&#x2F;step (Level 1) to 80ms&#x2F;step (Level 8).</li>
</ul>
</li>
<li><strong>Collision Detection</strong><ul>
<li><strong>Food Consumption</strong>: Increases snake length and triggers sound effects.</li>
<li><strong>Boundary&#x2F;Body Collision</strong>: Ends the game and resets progress.</li>
</ul>
</li>
</ol>
<h4 id="Data-Structures"><a href="#Data-Structures" class="headerlink" title="Data Structures"></a>Data Structures</h4><ul>
<li><code>snake_body_t</code>: Stores coordinates of snake segments.</li>
<li><code>my_eat_snake</code>: Manages snake length, position, and growth.</li>
<li><code>my_snake_food</code>: Tracks food location and remaining count.</li>
</ul>
<hr>
<h3 id="Personalized-Audio-System"><a href="#Personalized-Audio-System" class="headerlink" title="Personalized Audio System"></a>Personalized Audio System</h3><h4 id="PWM-Driven-Sound-Effects"><a href="#PWM-Driven-Sound-Effects" class="headerlink" title="PWM-Driven Sound Effects"></a>PWM-Driven Sound Effects</h4><p>The speaker was controlled via GPIO 27 using <strong>Pulse Width Modulation (PWM)</strong>. Key steps:</p>
<ol>
<li>PWM Configuration<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">gpio_set_function(<span class="number">27</span>, GPIO_FUNC_PWM);  </span><br><span class="line">pwm_config config = pwm_get_default_config();  </span><br><span class="line">pwm_config_set_clkdiv(&amp;config, <span class="number">1.f</span>);  </span><br><span class="line">pwm_config_set_wrap(&amp;config, <span class="number">20000</span>);  </span><br><span class="line">pwm_init(slice_num, &amp;config, <span class="literal">true</span>); </span><br></pre></td></tr></table></figure></li>
<li>Interrupt-Driven Audio Playback<ul>
<li>Defined musical notes (e.g., <code>C4=262Hz</code>, <code>D4=294Hz</code>) in an array.</li>
<li>Used <code>on_pwm_wrap()</code> interrupt to play:<ul>
<li><strong>Background Music</strong>: Triggered during gameplay (<code>sound_state[0] = 1</code>).</li>
<li><strong>Sound Effects</strong>: Played when eating food (<code>sound_state[1] = 1</code>) or game-over (<code>sound_state[1] = 2</code>).</li>
</ul>
</li>
</ul>
</li>
</ol>
<hr>
<h2 id="Challenges-Solutions"><a href="#Challenges-Solutions" class="headerlink" title="Challenges &amp; Solutions"></a>Challenges &amp; Solutions</h2><ol>
<li>Development Environment<ul>
<li>Issue: Keil MDK compatibility issues and compilation errors.</li>
<li>Solution: Migrated to Pico SDK with VS Code, reducing build time by 50%.</li>
</ul>
</li>
<li>Audio Quality Limitations<ul>
<li>Issue: Distortion due to PWM signal noise.</li>
<li>Solution: Implemented frequency modulation and fade effects to minimize noise.</li>
</ul>
</li>
<li>Memory Optimization<ul>
<li>Issue: LVGL memory spikes during animations.</li>
<li>Solution: Reduced buffer sizes and simplified widget hierarchies.</li>
</ul>
</li>
</ol>
<h2 id="Conclusion-Learning-Outcomes"><a href="#Conclusion-Learning-Outcomes" class="headerlink" title="Conclusion &amp; Learning Outcomes"></a>Conclusion &amp; Learning Outcomes</h2><p>This project enhanced my expertise in <strong>embedded systems, real-time programming</strong>, and <strong>GUI development</strong>. Key takeaways:</p>
<ul>
<li><strong>Adaptability</strong>: Successfully pivoted toolsets to overcome environmental hurdles.</li>
<li><strong>Problem-Solving</strong>: Debugged hardware-software integration challenges.</li>
<li><strong>Creativity</strong>: Designed a responsive GUI and dynamic audio system within resource constraints.</li>
</ul>
<p><strong>Full Code &amp; Documentation</strong>: <a href="https://github.com/Minkai-Shi/Snake-Game">GitHub Repository</a></p>
<p><strong>Demo Video</strong>: <a href="https://youtu.be/m1qLWg0Lp00">https://youtu.be/m1qLWg0Lp00</a></p>
<p><strong>EEPW Forum Post</strong>:<br><a href="https://forum.eepw.com.cn/thread/384440/1">https://forum.eepw.com.cn/thread/384440/1</a><br><a href="https://forum.eepw.com.cn/thread/384453/1">https://forum.eepw.com.cn/thread/384453/1</a><br><a href="https://forum.eepw.com.cn/thread/384471/1">https://forum.eepw.com.cn/thread/384471/1</a><br><a href="https://forum.eepw.com.cn/thread/384521/1">https://forum.eepw.com.cn/thread/384521/1</a></p>
<hr>
]]></content>
      <categories>
        <category>EEPW &amp; EEWorld Activity</category>
      </categories>
      <tags>
        <tag>EEPW &amp; EEWorld Activity</tag>
      </tags>
  </entry>
  <entry>
    <title>Yongsheng 601 pump piston lubrication and sealing tutorial</title>
    <url>/2024/03/30/Yongsheng-601-pump-piston-renew/</url>
    <content><![CDATA[<p>Yongsheng 601 pump piston lubrication and sealing tutorial.<br><img src="/upload/pic4.jpg" alt="pic4" title="pic4"><br> Drain ink, repeatedly inhale and spit out clean water to ensure no high concentration of ink residue, use factory disassembly, wrench or pliers to unscrew the piston, clean the inner wall of the pen holder and the mixture of ink and water on the piston with a dust-free tissue.<br>  Apply a circle of silicone oil to the piston head groove, use the previous tool to rotate the pen holder back, press a few times before absorbing ink, and ensure that it is evenly distributed inside the pen holder,That’s all.</p>
]]></content>
      <categories>
        <category>pen</category>
      </categories>
      <tags>
        <tag>pen</tag>
      </tags>
  </entry>
  <entry>
    <title>Hello World</title>
    <url>/2024/02/14/hello-world/</url>
    <content><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>
]]></content>
  </entry>
  <entry>
    <title>Leica Barnac minor repairs (iiic)</title>
    <url>/2024/02/16/repairs/</url>
    <content><![CDATA[<p>   sometimes cause slow doors to fail and fail to trigger damping, resulting in 1~20 and B doors always being at a speed of 1&#x2F;30. It is possible that a small spring has pushed against the top cover.<br><img src="/upload/pic1.jpg" alt="pic1" title="pic1"><br>   Open the top cover, find it, and press it in the direction of the arrow in the diagram to make it slightly straight. Before reinstalling the cover, test the shutter speed to ensure that the spring tube is not too straight, causing damping to be triggered when the speed is above 1&#x2F;20<br><img src="/upload/pic2.jpg" alt="pic2" title="pic2"><br><img src="/upload/pic3.jpg" alt="pic3" title="pic3"></p>
]]></content>
      <categories>
        <category>camera</category>
      </categories>
      <tags>
        <tag>camera</tag>
      </tags>
  </entry>
  <entry>
    <title>EEWORLD “Follow Me” Season 3 – Task 2</title>
    <url>/2025/09/02/EEWORLD-Follow-Me-Season-3/</url>
    <content><![CDATA[<!-- HEADER -->
<h1 align="center">🔧 EEWORLD「Follow Me 第三季·第2期」任务</h1>
<h3 align="center">EEWORLD “Follow Me” Season 3 – Task 2</h3>

<p align="center">
  <a href="https://bbs.eeworld.com.cn/thread-1327003-1-1.html">📎 作品发布帖</a> •
  <a href="https://www.eeworld.com.cn/huodong/digikey_follow_me_2025_02/">🌐 活动主页</a> •
  <a href="https://github.com/Minkai-Shi">📁 我的嵌入式项目合集</a>
</p>

<hr>
<h2 id="🧭-项目简介-Project-Overview"><a href="#🧭-项目简介-Project-Overview" class="headerlink" title="🧭 项目简介 | Project Overview"></a>🧭 项目简介 | Project Overview</h2><p><strong>中文说明</strong><br>本项目是我参与 <strong>EEWORLD × DigiKey 联合举办的「Follow Me 第三季·第2期」嵌入式实践挑战</strong>。<br>活动旨在鼓励开发者亲手完成指定任务，从硬件连接、程序调试到功能扩展，完整体验嵌入式系统的开发流程。  </p>
<p>我选择了基于 <strong>MCU 外设控制与通信调试</strong> 的任务方向，重点在于<strong>分析系统结构、验证通信接口、优化运行稳定性</strong>，并在论坛发布调试日志和经验总结。  </p>
<p><strong>English Description</strong><br>This project documents my participation in <strong>EEWORLD &amp; DigiKey’s “Follow Me” Season 3 – Task 2</strong>,<br>a hands-on embedded systems challenge designed to promote <strong>practical engineering, debugging, and system design skills</strong>.  </p>
<p>I focused on tasks related to <strong>MCU peripheral configuration, hardware communication, and stability optimization</strong>,<br>recording each stage from schematic understanding to firmware debugging on the official EEWORLD forum.</p>
<hr>
<h2 id="🎯-活动目标-Objectives"><a href="#🎯-活动目标-Objectives" class="headerlink" title="🎯 活动目标 | Objectives"></a>🎯 活动目标 | Objectives</h2><table>
<thead>
<tr>
<th>中文</th>
<th>English</th>
</tr>
</thead>
<tbody><tr>
<td>✅ 按照任务教程搭建系统硬件并完成代码调试</td>
<td>✅ Reproduce and verify the assigned embedded project</td>
</tr>
<tr>
<td>⚙️ 掌握外设接口初始化与数据通信机制</td>
<td>⚙️ Understand peripheral initialization and data communication</td>
</tr>
<tr>
<td>🔍 记录调试中遇到的问题与解决方法</td>
<td>🔍 Document debugging issues and solutions</td>
</tr>
<tr>
<td>🚀 尝试功能扩展与性能优化</td>
<td>🚀 Extend system functionality and optimize performance</td>
</tr>
</tbody></table>
<hr>
<h2 id="⚙️-硬件与开发环境-Hardware-Tools"><a href="#⚙️-硬件与开发环境-Hardware-Tools" class="headerlink" title="⚙️ 硬件与开发环境 | Hardware &amp; Tools"></a>⚙️ 硬件与开发环境 | Hardware &amp; Tools</h2><table>
<thead>
<tr>
<th>类别</th>
<th>说明</th>
<th>Category</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>主控平台</td>
<td>FRDM-MCXN947 开发板</td>
<td>FRDM-MCXN947 development board</td>
<td>This is a low-cost design and evaluation board based on the MCXN947 device, which integrates a dual-core Arm Cortex-M33 microcontroller and one Neural Processing Unit (NPU) in a single package. NXP provides tools and software support for the device, including hardware evaluation boards, software development Integrated Development Environment (IDE), sample applications, and drivers.</td>
</tr>
<tr>
<td>外设模块</td>
<td>OLED 屏幕 &#x2F; 传感器模块 &#x2F; 通信模块</td>
<td>Peripherals</td>
<td>OLED display, sensor, communication units</td>
</tr>
<tr>
<td>通信接口</td>
<td>I²C &#x2F; SPI &#x2F; UART</td>
<td>Interface</td>
<td>Data exchange and debugging</td>
</tr>
<tr>
<td>开发软件</td>
<td>VS Code</td>
<td>Software</td>
<td>Embedded C IDEs and toolchains</td>
</tr>
</tbody></table>
<hr>
<h2 id="🧠-技术实现-Technical-Implementation"><a href="#🧠-技术实现-Technical-Implementation" class="headerlink" title="🧠 技术实现 | Technical Implementation"></a>🧠 技术实现 | Technical Implementation</h2><h3 id="1️⃣-外设初始化与通信验证-Peripheral-Initialization-Interface-Verification"><a href="#1️⃣-外设初始化与通信验证-Peripheral-Initialization-Interface-Verification" class="headerlink" title="1️⃣ 外设初始化与通信验证 | Peripheral Initialization &amp; Interface Verification"></a>1️⃣ 外设初始化与通信验证 | Peripheral Initialization &amp; Interface Verification</h3><ul>
<li>确认 I²C 与 SPI 模块地址、通信速率与电源逻辑；</li>
<li>在主循环中加入 LED 心跳指示，用于调试状态监控。</li>
</ul>
<blockquote>
<p>Verified I²C&#x2F;SPI communication, analyzed signal timing using a logic analyzer,<br>and implemented LED heartbeat for runtime status indication.</p>
</blockquote>
<hr>
<h3 id="2️⃣-固件适配与结构优化-Firmware-Adaptation-Optimization"><a href="#2️⃣-固件适配与结构优化-Firmware-Adaptation-Optimization" class="headerlink" title="2️⃣ 固件适配与结构优化 | Firmware Adaptation &amp; Optimization"></a>2️⃣ 固件适配与结构优化 | Firmware Adaptation &amp; Optimization</h3><ul>
<li>基于 HAL 库重写驱动层结构，增强模块化与可读性；</li>
<li>调整初始化顺序，确保外设与 OLED 屏幕正确同步；</li>
<li>通过 UART 输出调试日志，便于后续问题定位。</li>
</ul>
<blockquote>
<p>Rewrote driver initialization sequences to ensure synchronized peripheral startup.<br>Added UART logging for dynamic debugging and firmware validation.</p>
</blockquote>
<hr>
<h3 id="3️⃣-问题与解决方案-Debugging-Solutions"><a href="#3️⃣-问题与解决方案-Debugging-Solutions" class="headerlink" title="3️⃣ 问题与解决方案 | Debugging &amp; Solutions"></a>3️⃣ 问题与解决方案 | Debugging &amp; Solutions</h3><table>
<thead>
<tr>
<th>问题</th>
<th>原因分析</th>
<th>解决方法</th>
<th>Issue</th>
<th>Solution</th>
</tr>
</thead>
<tbody><tr>
<td>OLED 显示闪烁</td>
<td>初始化时序错误</td>
<td>增加延时并重设复位逻辑</td>
<td>OLED flicker</td>
<td>Adjusted reset delay sequence</td>
</tr>
<tr>
<td>I²C 超时</td>
<td>导线过长造成信号干扰</td>
<td>缩短连线并优化接地布局</td>
<td>I²C timeout</td>
<td>Rewired shorter SDA&#x2F;SCL paths</td>
</tr>
<tr>
<td>编译警告</td>
<td>类型不匹配</td>
<td>修正宏定义与结构体声明</td>
<td>Compiler warning</td>
<td>Fixed type mismatches in headers</td>
</tr>
</tbody></table>
<hr>
<h2 id="📊-项目成果-Results"><a href="#📊-项目成果-Results" class="headerlink" title="📊 项目成果 | Results"></a>📊 项目成果 | Results</h2><ul>
<li>成功完成任务功能并扩展稳定性测试；</li>
<li>实现<strong>实时数据采集 + OLED 可视化显示</strong>；</li>
<li>记录完整调试过程及经验总结。</li>
</ul>
<blockquote>
<p>Achieved stable real-time sensor reading and OLED visualization,<br>with all debugging steps documented for reproducibility.</p>
</blockquote>
<p align="center">
  <img src="https://bbs.eeworld.com.cn/data/attachment/forum/202310/ee-demo.jpg" width="70%">
</p>

<hr>
<h2 id="💡-学习与收获-Learning-Outcomes"><a href="#💡-学习与收获-Learning-Outcomes" class="headerlink" title="💡 学习与收获 | Learning Outcomes"></a>💡 学习与收获 | Learning Outcomes</h2><table>
<thead>
<tr>
<th>中文</th>
<th>English</th>
</tr>
</thead>
<tbody><tr>
<td>📘 深入理解嵌入式系统调试流程与问题定位方法</td>
<td>📘 Strengthened understanding of embedded debugging methodology</td>
</tr>
<tr>
<td>🔬 掌握信号级别问题分析与外设配置技巧</td>
<td>🔬 Gained experience in signal-level diagnostics</td>
</tr>
<tr>
<td>🧩 培养系统化思维与工程严谨性</td>
<td>🧩 Developed systematic problem-solving mindset</td>
</tr>
</tbody></table>
<blockquote>
<p>“每一次错误都让我离正确更近一步。”<br>“Every malfunction became a lesson — every successful fix, a confirmation of understanding.”</p>
</blockquote>
<hr>
<h2 id="🧭-反思与延伸-Reflection-Future-Work"><a href="#🧭-反思与延伸-Reflection-Future-Work" class="headerlink" title="🧭 反思与延伸 | Reflection &amp; Future Work"></a>🧭 反思与延伸 | Reflection &amp; Future Work</h2><p><strong>中文：</strong><br>通过此次任务，我更加理解了工程师思维：<br>问题不是障碍，而是验证假设与改进设计的机会。<br>后续我将把这种调试与验证方法应用到更复杂的 AI 嵌入式系统（如 MAX78000 智能手环）中。</p>
<p><strong>English:</strong><br>This task strengthened my engineering mindset —<br>to approach problems through analysis, hypothesis, and validation.<br>I plan to apply this methodology to larger-scale embedded AI systems such as the MAX78000 Health Monitoring Wristband.</p>
<hr>
<h2 id="🔗-参考与相关链接-References"><a href="#🔗-参考与相关链接-References" class="headerlink" title="🔗 参考与相关链接 | References"></a>🔗 参考与相关链接 | References</h2><ul>
<li><a href="https://www.eeworld.com.cn/huodong/digikey_follow_me_2025_02/">EEWORLD 活动主页 &#x2F; Official Event Page</a>  </li>
<li><a href="https://bbs.eeworld.com.cn/thread-1327003-1-1.html">论坛作品发布帖 &#x2F; Project Submission</a>  </li>
<li><a href="https://minkai-shi.github.io/categories/EEPW-EEWorld-Activity/">EEPW &amp; EEWorld 项目合集 &#x2F; My Embedded Project Collection</a>  </li>
<li><a href="https://www.digikey.com/">DigiKey 官方网站 &#x2F; DigiKey Official</a></li>
</ul>
<hr>
<h2 id="🧩-标签-Tags"><a href="#🧩-标签-Tags" class="headerlink" title="🧩 标签 | Tags"></a>🧩 标签 | Tags</h2><p><code>Embedded Systems</code> · <code>Hardware Debugging</code> · <code>EEWORLD</code> · <code>DigiKey</code> · <code>I2C</code> · <code>Firmware Engineering</code></p>
<hr>
<p><strong>作者 &#x2F; Author:</strong> Minkai Shi<br><strong>日期 &#x2F; Date:</strong> 2025<br><strong>许可证 &#x2F; License:</strong> MIT  </p>
]]></content>
      <categories>
        <category>EEPW &amp; EEWorld Activity</category>
      </categories>
      <tags>
        <tag>EEPW &amp; EEWorld Activity</tag>
      </tags>
  </entry>
  <entry>
    <title>Smart Health Monitoring Wristband</title>
    <url>/2025/10/06/Smart-Health-Monitoring-Wristband/</url>
    <content><![CDATA[<h1 id="🩺-Smart-Health-Monitoring-Wristband-智能健康监测手环"><a href="#🩺-Smart-Health-Monitoring-Wristband-智能健康监测手环" class="headerlink" title="🩺 Smart Health Monitoring Wristband &#x2F; 智能健康监测手环"></a>🩺 Smart Health Monitoring Wristband &#x2F; 智能健康监测手环</h1><h3 id="Embedded-System-Based-on-MAX78000FTHR-基于-MAX78000FTHR-的嵌入式系统"><a href="#Embedded-System-Based-on-MAX78000FTHR-基于-MAX78000FTHR-的嵌入式系统" class="headerlink" title="Embedded System Based on MAX78000FTHR &#x2F; 基于 MAX78000FTHR 的嵌入式系统"></a>Embedded System Based on MAX78000FTHR &#x2F; 基于 MAX78000FTHR 的嵌入式系统</h3><p><a href=""><img src="https://img.shields.io/badge/Platform-MAX78000FTHR-blue.svg" alt="Platform"></a><br><a href=""><img src="https://img.shields.io/badge/Award-EEPW%20%26%20DigiKey%20DIY%20Challenge%202024-brightgreen.svg" alt="Award"></a><br><a href=""><img src="https://img.shields.io/badge/Language-C%2FC%2B%2B-lightgrey.svg" alt="Language"></a><br><a href=""><img src="https://img.shields.io/badge/Status-Completed-success.svg" alt="Status"></a>  </p>
<p>A DIY low-power health monitoring wristband built on the MAX78000FTHR platform, focusing on <strong>embedded system design</strong> and <strong>real-time biosignal processing</strong>.<br>该项目基于 MAX78000FTHR 平台开发低功耗健康监测手环，重点展示嵌入式系统设计与实时生理信号处理能力。  </p>
<hr>
<h2 id="📷-Project-Overview-项目概述"><a href="#📷-Project-Overview-项目概述" class="headerlink" title="📷 Project Overview &#x2F; 项目概述"></a>📷 Project Overview &#x2F; 项目概述</h2><p align="center">
  <img src="https://minkai-shi.github.io/upload/SMART_HEALTH_BLOCK_DIAGRAM.png" width="600" alt="System Block Diagram"/>
</p>

<p>With wearable health devices growing in popularity, this project explores <strong>how embedded systems acquire and process biosignals in real time</strong>.<br>随着可穿戴健康设备的普及，本项目旨在探索嵌入式系统如何实时采集与处理生理信号。  </p>
<p><strong>Features &#x2F; 功能特点：</strong>  </p>
<ul>
<li>RGB LED 指示系统状态 &#x2F; RGB LED system status indication  </li>
<li>实时心率与血氧测量（1Hz 刷新） &#x2F; Real-time HR &amp; SpO₂ (1Hz refresh)  </li>
<li>OLED 三层菜单界面 &#x2F; OLED 3-level interactive menu  </li>
<li>RTC 实时时钟显示 &#x2F; RTC timekeeping  </li>
<li>双按键交互（SW1 菜单切换，SW2 确认） &#x2F; Button control (SW1 menu, SW2 confirm)</li>
</ul>
<hr>
<h2 id="⚙️-Hardware-Architecture-硬件架构"><a href="#⚙️-Hardware-Architecture-硬件架构" class="headerlink" title="⚙️ Hardware Architecture &#x2F; 硬件架构"></a>⚙️ Hardware Architecture &#x2F; 硬件架构</h2><table>
<thead>
<tr>
<th>Component &#x2F; 组件</th>
<th>Model &#x2F; 型号</th>
<th>Function &#x2F; 功能</th>
</tr>
</thead>
<tbody><tr>
<td><strong>MCU</strong></td>
<td>MAX78000FTHR</td>
<td>Cortex-M4 MCU，支持 NPU 与 I²C 通信</td>
</tr>
<tr>
<td><strong>Sensor &#x2F; 传感器</strong></td>
<td>MAXREFDES117 (MAX30102)</td>
<td>PPG 双通道红外&#x2F;红光心率与血氧采集</td>
</tr>
<tr>
<td><strong>Display &#x2F; 显示屏</strong></td>
<td>SSD1306 0.96” OLED</td>
<td>实时数据显示 128×64 I²C 屏幕</td>
</tr>
<tr>
<td><strong>Clock &#x2F; 时钟模块</strong></td>
<td>DS3231 RTC</td>
<td>硬件时钟模块</td>
</tr>
<tr>
<td><strong>Accessories &#x2F; 配件</strong></td>
<td>Breadboard, Jumpers</td>
<td>原型连接，I²C 线长优化 &lt;5cm</td>
</tr>
</tbody></table>
<blockquote>
<p>The MAX78000’s built-in NPU allows for potential <strong>AI-based health analytics</strong>, while maintaining ultra-low power consumption.<br>MAX78000 内置神经网络加速单元 (NPU)，具备未来 AI 健康分析潜力，同时保持极低功耗。  </p>
</blockquote>
<hr>
<h2 id="🧠-Development-Environment-开发环境"><a href="#🧠-Development-Environment-开发环境" class="headerlink" title="🧠 Development Environment &#x2F; 开发环境"></a>🧠 Development Environment &#x2F; 开发环境</h2><ul>
<li><strong>IDE:</strong> Visual Studio Code + Cortex-Debug  </li>
<li><strong>SDK:</strong> Analog Devices MSDK  </li>
<li><strong>Toolchain:</strong> GCC ARM Embedded 10.3 + Makefile  </li>
<li><strong>Communication:</strong> I²C @ 100kHz (optimized timing)  </li>
<li><strong>Algorithms &#x2F; 算法：</strong>  <ul>
<li>滑动窗口滤波 &#x2F; Sliding window filter  </li>
<li>峰值检测 &#x2F; Peak detection  </li>
<li>比率法血氧计算 &#x2F; Ratio-based SpO₂ estimation<br><em>(Adapted from <code>maxim_heart_rate_and_oxygen_saturation</code> in <code>algorithm.h</code>)</em></li>
</ul>
</li>
</ul>
<hr>
<h2 id="🔧-Key-Technical-Challenges-技术难点与解决方案"><a href="#🔧-Key-Technical-Challenges-技术难点与解决方案" class="headerlink" title="🔧 Key Technical Challenges &#x2F; 技术难点与解决方案"></a>🔧 Key Technical Challenges &#x2F; 技术难点与解决方案</h2><table>
<thead>
<tr>
<th>Problem &#x2F; 问题</th>
<th>Cause &#x2F; 原因</th>
<th>Solution &#x2F; 解决方案</th>
<th>Result &#x2F; 结果</th>
</tr>
</thead>
<tbody><tr>
<td>字库乱码 &#x2F; Font corruption</td>
<td>C 注释转义错误</td>
<td>重定义特殊字符</td>
<td>字符显示正常</td>
</tr>
<tr>
<td>I²C 信号不稳定</td>
<td>面包板连线过长</td>
<td>缩短连线至 &lt;5cm</td>
<td>数据丢失率 &lt;0.1%</td>
</tr>
<tr>
<td>OLED 文字镜像</td>
<td>初始化寄存器错误</td>
<td>调整 <code>0xC0/0xC8</code> 参数</td>
<td>显示方向正确</td>
</tr>
<tr>
<td>数据刷新延迟 200ms+</td>
<td>同步读取与绘制阻塞</td>
<td>分离采样与渲染中断</td>
<td>延迟 &lt;50ms</td>
</tr>
</tbody></table>
<hr>
<h2 id="💻-Core-Functions-核心功能示例"><a href="#💻-Core-Functions-核心功能示例" class="headerlink" title="💻 Core Functions &#x2F; 核心功能示例"></a>💻 Core Functions &#x2F; 核心功能示例</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">// RGB LED Control / RGB LED 控制</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">SetLEDs</span><span class="params">(<span class="type">uint8_t</span> state)</span> &#123;</span><br><span class="line">    MXC_I2C_WriteByte(I2C0, PMIC_ADDR, LED_REG, state);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// HR &amp; SpO₂ Calculation / 心率与血氧算法</span></span><br><span class="line">maxim_heart_rate_and_oxygen_saturation(ir_data, red_data,</span><br><span class="line">    &amp;spo2, &amp;heart_rate, &amp;valid_spo2, &amp;valid_hr);</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="🚀-Future-Work-后续计划"><a href="#🚀-Future-Work-后续计划" class="headerlink" title="🚀 Future Work &#x2F; 后续计划"></a>🚀 Future Work &#x2F; 后续计划</h2><ul>
<li>设计定制 PCB，缩小体积 60%  </li>
<li>基于 NPU 实现 CNN 异常心率检测  </li>
<li>加入 BLE 蓝牙通信模块（MAX32660）  </li>
<li>优化低功耗休眠模式，续航 7+ 天</li>
</ul>
<hr>
<h2 id="🧭-Learnings-项目收获"><a href="#🧭-Learnings-项目收获" class="headerlink" title="🧭 Learnings &#x2F; 项目收获"></a>🧭 Learnings &#x2F; 项目收获</h2><p>This project deepened understanding of <strong>embedded firmware, biosignal processing, and system optimization</strong>, demonstrating how theory translates to real applications.<br>本项目加深了我对嵌入式固件开发、生理信号处理与系统优化的理解，实现了从理论到实践的完整闭环。  </p>
<hr>
<h2 id="🙏-Acknowledgments-致谢"><a href="#🙏-Acknowledgments-致谢" class="headerlink" title="🙏 Acknowledgments &#x2F; 致谢"></a>🙏 Acknowledgments &#x2F; 致谢</h2><p>Special thanks to <strong>EEPW</strong> and <strong>DigiKey</strong> for hardware support.<br>特别感谢《电子工程与产品世界》和 DigiKey 提供硬件支持。  </p>
<p>📎 <strong>GitHub Repository:</strong> (<a href="https://github.com/Minkai-Shi/Smart-Health-Monitoring-Wristband">https://github.com/Minkai-Shi/Smart-Health-Monitoring-Wristband</a>)</p>
<h2 id="🎥-Project-Demonstration-Video-项目演示视频"><a href="#🎥-Project-Demonstration-Video-项目演示视频" class="headerlink" title="🎥 Project Demonstration Video &#x2F; 项目演示视频"></a>🎥 Project Demonstration Video &#x2F; 项目演示视频</h2><iframe width="560" height="315" src="https://www.youtube.com/embed/Fb3Psc4_ksg" title="DIY Smart Health Monitoring Wristband – YouTube" frameborder="0" allow="accelerometer; autoplay; clipboard‑write; encrypted‑media; gyroscope; picture‑in‑picture" allowfullscreen></iframe>

<blockquote>
<p>📺 <a href="https://youtu.be/Fb3Psc4_ksg">YouTube Video Link &#x2F; 视频链接</a></p>
</blockquote>
<hr>
<h2 id="🌐-Official-Event-EEPW-Forum-Posts-官方活动与论坛帖子"><a href="#🌐-Official-Event-EEPW-Forum-Posts-官方活动与论坛帖子" class="headerlink" title="🌐 Official Event &amp; EEPW Forum Posts &#x2F; 官方活动与论坛帖子"></a>🌐 Official Event &amp; EEPW Forum Posts &#x2F; 官方活动与论坛帖子</h2><ul>
<li><strong>EEPW x DigiKey Smart Wristband DIY Challenge (Official Page)</strong><br>🔗 <a href="https://www.eepw.com.cn/event/action/digikey/diy_2025_sec.html">https://www.eepw.com.cn/event/action/digikey/diy_2025_sec.html</a></li>
</ul>
<h3 id="📄-My-EEPW-Forum-Posts-我在-EEPW-的参赛记录"><a href="#📄-My-EEPW-Forum-Posts-我在-EEPW-的参赛记录" class="headerlink" title="📄 My EEPW Forum Posts &#x2F; 我在 EEPW 的参赛记录"></a>📄 My EEPW Forum Posts &#x2F; 我在 EEPW 的参赛记录</h3><ol>
<li><a href="https://forum.eepw.com.cn/thread/396901/1">Project Log #1 – Hardware Design and Wiring 硬件设计与布线</a>  </li>
<li><a href="https://forum.eepw.com.cn/thread/396903/1">Project Log #2 – Algorithm Development and Debug 调试与算法实现</a>  </li>
<li><a href="https://forum.eepw.com.cn/thread/396904/1">Project Log #3 – Final Testing and Optimization 测试与优化总结</a></li>
</ol>
]]></content>
      <categories>
        <category>EEPW &amp; EEWorld Activity</category>
      </categories>
      <tags>
        <tag>EEPW &amp; EEWorld Activity</tag>
      </tags>
  </entry>
</search>
